#character.lic
=begin

Author: Alastir

Variables used: scent_container

=end

no_kill_all
no_pause_all

if Char.name == 'Alastir'
	$scents = [ 'crystal bottle','blackened bottle','soapstone bottle','shadowglass bottle','glass bottle' ]
end

loop {
while line = get
#Automation
	if line =~ /(.*) to be your default weapon./
		Vars['weapon'] = $1.split.last
	elsif Room.current.id == 26833
		if checkgrouped == false
			if GameObj.pcs.count > 1
				if Char.name == Vars.groupleader
				else
					fput "join #{Vars.groupleader}"
				end
			end
		end
	elsif line =~ /You feel at full magical power again./
		fput 'infuse 1'
		if Room.current.id == 26833									#[Journey's End, Study]
			if Char.prof == 'Bard' or 'Cleric' or 'Wizard'
				start_script ('waggle')
			end
		elsif Room.current.id == 29623								#[Estate, Greatroom - 29623]
			if Char.prof == 'Bard' or 'Cleric' or 'Wizard'
				start_script ('waggle')
			end
		end
	elsif line =~ /Your magic fizzles ineffectually./
		kill_script ('waggle') if Script.running?('waggle')

#Alastir
	elsif line =~ /You suddenly notice that your mirror-finish glasses have slipped and are now perching precariously on the tip of your nose./
		fput 'push my glasses'
	elsif line =~ /The subtle scent which had been clinging to you dissipates./
		if Char.name == 'Alastir'
			empty_hands
			sample = $scents.sample
			fput "get #{sample} from my #{Vars.scent_container}"
			fput 'pour my bottle on Alastir'
			fput "put my bottle in my #{Vars.scent_container}"
			fill_hands
		end
	elsif line =~ /#{Vars.weapon} stops glowing/
		Spell[902].cast if Spell[902].affordable?
	elsif line =~ /We've noted a troubling increase in bandit activity recently./
		if Char.name == 'Alastir'
			waitrt?
			waitcastrt?
			fput 'stop 520'
			fput 'incant 520 lightning' if checkmana(20)
		end
	elsif line =~ /Unfortunately, I need a specific variety that only grows in Old Ta'Faendryl.|It appears they need your help in tracking down some kind of lost heirloom.|We'd like you to cull their numbers a bit for us.|I've recently received several orders from customers interested in purchasing/
		if Char.name == 'Alastir'
			waitrt?
			waitcastrt?
			fput 'stop 520'
			fput 'incant 520 water' if checkmana(20)
		end
	elsif line =~ /You cannot do that while mounted./
		fput 'dismount'
	
	elsif line =~ /You are unable to hold the number of items/
		kill_script('foreach') if Script.running?('foreach')

#Warrior
	elsif line =~ /Dozens of silk threads spin into action, ensnaring your body!|The wisps solidify into thick strands of webbing that tighten about your body!/
		fput 'berserk'
	elsif line =~ /A high steel harpoon rises out of the shadows and flies back to your waiting hand!|You spy a high steel harpoon and recover it./
		$weapon_lost = false
	elsif line =~ /With a quick flick of your wrist, you deftly send a high steel harpoon into flight./
		$weapon_lost = true
		$weapon_hurled_room = Room.current.id	

#Duskruin
	elsif line =~ /offers you/
		fput 'accept'
		if GameObj.right_hand.noun =~ /^(?:note|scrip|chit)$/
			fput "put ##{GameObj.right_hand.id} in my #{Vars.keepsack}"
		end
		if GameObj.left_hand.noun =~ /^(?:note|scrip|chit)$/
			fput "put ##{GameObj.left_hand.id} in my #{Vars.keepsack}"
		end
		if GameObj.right_hand.noun =~ /booklet/
			fput "put my booklet in my #{Vars.bookletsack}"
		elsif GameObj.right_hand.name == 'indigo-black seashells'
			fput 'redeem seashells'
		elsif GameObj.right_hand.noun =~ /bloodscrip/
			multifput 'accept', 'look my bloodscrip', 'redeem bloodscrip'
		end

#Hunting
	elsif line =~ /As you start your inquiry, the Guard Captain abruptly interrupts, saying/
		fput 'ask guardsman about bounty'
	elsif line =~ /removes (.*) from your corpse/
		if $frontend == 'stormfront'
			fam_window_begin = "<pushStream id=\"death\" ifClosedStyle=\"watching\"/>"
			fam_window_end   = "<popStream/>\r\n"
		end
		item = $1
		puts("#{fam_window_begin}** #{item} stolen at #{Room.current.id}.\r\n#{fam_window_end}")
	
#Kraken Falls Bandit Hunting
	elsif line =~ /The crystal shatters against your body and releases a pulse of anti-magic!/
		Script.start('waggle')
	elsif line =~ /You have completed this portion of your Adventurer's Guild task./
		$alastir_complete = true

	elsif line =~ /You need to kill ([\d,]+) of them to complete your task./
		$bandit_quantity = $1
	elsif line =~ /You need to kill ([\d,]+) more of them to complete your task./
		$bandit_quantity = $1
	elsif line =~ /\[You have ([\d,]+) kills remaining.\]/
		$bandit_quantity = $1
	elsif line =~ /You have completed this portion of your Adventurer's Guild task.|You succeeded in your task and should report back to the sentry just outside Kraken's Fall./
		$bandit_quantity = 0

	elsif line =~ /Devereux switches to a slightly aggressive stance.|Devereux moves into a defensive stance, ready to fend off an attack./
		$devereux_ready = true
	elsif line =~ /Erykk moves into a defensive stance, ready to fend off an attack.|Erykk moves into a defensive stance, clearly guarding himself./
		$erykk_ready = true
	elsif line =~ /Ganalon moves into a defensive stance, ready to fend off an attack.|Ganalon moves into a defensive stance, clearly guarding himself./
		$ganalon_ready = true
	elsif line =~ /Marchese moves into a defensive stance, ready to fend off an attack.|Marchese moves into a defensive stance, clearly guarding himself./
		$marchese_ready = true
	elsif line =~ /Rylohk moves into a defensive stance, ready to fend off an attack.|Rylohk moves into a defensive stance, clearly guarding himself./
		$rylohk_ready = true

	elsif line =~ /Devereux whispers, "I need (.*) more."/
		$devereux_complete = false
	elsif line =~ /Erykk whispers, "I need (.*) more."/
		$erykk_complete = false
	elsif line =~ /Ganalon whispers, "I need (.*) more."/
		$ganalon_complete = false
	elsif line =~ /Marchese whispers, "I need (.*) more."/
		$marchese_complete = false
	elsif line =~ /Rylohk whispers, "I need (.*) more."/
		$rylohk_complete = false
	
	elsif line =~ /Devereux whispers, "Finished."/
		$devereux_complete = true
	elsif line =~ /Erykk whispers, "Finished."/
		$erykk_complete = true
	elsif line =~ /Ganalon whispers, "Finished."/
		$ganalon_complete = true
	elsif line =~ /Marchese whispers, "Finished."/
		$marchese_complete = true
	elsif line =~ /Rylohk whispers, "Finished."/
		$rylohk_complete = true

	end
end
}