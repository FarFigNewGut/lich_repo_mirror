=begin

	GUESS WHO!
	
	How is it that your character knows EVERYONE'S name in game, even if they have never interacted with the person before or saw anyone else use their name? Well this script aims to remedy that! (eventually!)
	
	With this script running whenever you LOOK in a room you will only see people referred to as "Unknown", until you decide you have sufficiently been introduced to them (or found out their name some other way), then you can do:
	
	;send guess add name
	
	For example: ;send guess add Dreaven
	
	To add them to the list of characters you know. From that point on that person's name will show up as normal in the room list.
	
	All "Unknown" people will have a number after their name, and this number will forever identify the same person. For example if the script notes Dreaven as "Unknown123", then Dreaven will forever be known as "Unknown123" until you add his name to the list.
	
	Eventually the script will use this unknown identifier in ALL instances of the person's name being shown (when LOOKing at them, when they use a verb, say something, etc) but for now it's just when LOOKing in a room.
	
	Commands:
	
	To add someone you know to your list of known characters: ;send guess add name"
	To remove someone from your list of known characters: ;send guess remove name"
	To reset your known list: ;send guess reset known"
	To reset your unknown list: ;send guess reset unknown"
	To see everyone on your known list: ;send guess list"
	
	Changelog:
	Version 1: Initial release!
	
	To do list:
	
	########################################################
	Ways to contact me:
	In game: Dreaven
	Player's Corner: Tgo01
	Discord: Dreaven#6436
	Email: LordDreaven@gmail.com
	If you like my scripts feel free to send me a tip via Paypal at: LordDreaven@gmail.com
	########################################################
	
	Author: Dreaven
	Version: 1

=end

CharSettings['list_of_known_characters'] = Array.new unless CharSettings['list_of_known_characters']
CharSettings['list_of_unknown_characters'] = Array.new unless CharSettings['list_of_unknown_characters']
@list_of_known_characters = CharSettings['list_of_known_characters']
@list_of_unknown_characters = CharSettings['list_of_unknown_characters']

hide_names = proc {
	action = proc { |server_string|
		if server_string =~ /^Also here\:/
			people_here = server_string.split(/Also here\: |\, /)
			new_line = "Also here: "
			people_here.each{ |full_info|
				if full_info =~ /noun="([a-zA-Z]+)"/
					name = $1
					if @list_of_known_characters.include?(name)
						new_line += "#{full_info}, "
					else
						@list_of_unknown_characters.push(name) unless @list_of_unknown_characters.include?(name)
						new_line += "Unknown#{@list_of_unknown_characters.find_index(name)}, "
					end
					@guess_who_last_character = name
				end
			}
			new_line = new_line.chop.chop
			new_line += "\r\n" unless @list_of_known_characters.include?(@guess_who_last_character)
			new_line
		else
			server_string
		end
	}
	DownstreamHook.add("#{script.name}_hide_names", action)
}

before_dying{
	DownstreamHook.remove("#{script.name}_hide_names")
	CharSettings['list_of_unknown_characters'] = @list_of_unknown_characters
}

hide_names.call

echo "To see list of commands enter: ;send guess help"

while line = get
	if line =~ /guess add ([a-zA-Z]+)/
		CharSettings['list_of_known_characters'].push($1) unless CharSettings['list_of_known_characters'].include?($1)
		@list_of_known_characters = CharSettings['list_of_known_characters']
		echo "#{$1} has been added to the list of characters you know!"
	elsif line =~ /guess remove ([a-zA-Z]+)/
		CharSettings['list_of_known_characters'].delete($1)
		@list_of_known_characters = CharSettings['list_of_known_characters']
		echo "#{$1} has been removed from the list of characters you know!"
	elsif line =~ /guess reset known/
		CharSettings['list_of_known_characters'] = Array.new
		@list_of_known_characters = CharSettings['list_of_known_characters']
		echo "#{$1} Your list of known characters has been reset. You now know no one!"
	elsif line =~ /guess reset unknown/
		CharSettings['list_of_unknown_characters'] = Array.new
		@list_of_unknown_characters = CharSettings['list_of_unknown_characters']
		echo "#{$1} Your list of unknown characters has been reset. You now don't know you don't know anyone!"
	elsif line =~ /guess list/
		respond CharSettings['list_of_unknown_characters']
	elsif line =~ /guess help/
		respond
		respond "guess-who commands:"
		respond "To add someone you know to your list of known characters: ;send guess add name"
		respond "To remove someone from your list of known characters: ;send guess remove name"
		respond "To reset your known list: ;send guess reset known"
		respond "To reset your unknown list: ;send guess reset unknown"
		respond "To see everyone on your known list: ;send guess list"
		respond
	end
end