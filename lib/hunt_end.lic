#hunt_end.lic
=begin

Author: Alastir

Variables used:
Vars.lootsack
Vars.gemsack -- Where to pull gems.
Vars.storage -- Where to place gems. (bookcase)
Vars.statue_storage -- Where to place statues. (shelves)

=end

if $frontend == 'stormfront'
	$fam_window_begin = "<pushStream id=\"announcements\" ifClosedStyle=\"watching\"/>"
	$fam_window_end   = "<popStream/>\r\n"
else
	$fam_window_begin = "\034GSe\r\n"
	$fam_window_end   = "\034GSf\r\n"
end

def enhancive_remove
	puts("#{$fam_window_begin}-- Removing enhancives.\r\n#{$fam_window_end}")
	Script.run('enhancive','remove')
end

def process_loot
	Script.run('treasure','store')
#	Script.run('foreach', "type=gem in my carryall;get item;put item in desk")
#	Script.run('foreach', "name=small statue in my carryall;get item;put item in locker")
#	Script.run('foreach', "type=collectible in my carryall;get item;put item in desk")
#	Script.run('foreach', "type=herb in my carryall;get item;put item in bar")	
end

##### MAIN LOOP

fput 'store all'

if Room.current.id == 26833 		#[Journey's End, Study]
	puts("#{$fam_window_begin}-- Running Journey's End, Study routine.\r\n#{$fam_window_end}")
	if Char.name == 'Alastir'
		if GameObj.right_hand.noun or GameObj.left_hand.noun == 'reins'
			fput 'put my reins in my harness'
		end
		if UserVars.enhancive_worn == true
			enhancive_remove
		end
	end
	if Char.name == 'Devereux'
		if UserVars.enhancive_worn == true
			enhancive_remove
		end
	end
	if Char.name == 'Erykk'
		if UserVars.enhancive_worn == true
			enhancive_remove
		end
	end
	Script.run('eherbs','in bar')
	start_room = Room.current
	Script.run('eherbs')
	Script.run('go2', start_room.id.to_s)
	Script.run('poolparty')
	puts("#{$fam_window_begin}-- Processing loot.\r\n#{$fam_window_end}")
	process_loot
	Script.run('silvers')
elsif Room.current.id == 29623		#[Estate, Greatroom - 29623]
	if Char.name == 'Devereux'
		fput 'tickle my armor'
		fput 'encumbrance'
	end
	Script.run('herbmaster',"in #{Vars.herbsack}")
	start_room = Room.current
	Script.run('herbheal')
	Script.run('go2', start_room.id.to_s)
	if percentencumbrance >= 10
		Script.run('poolparty')
		start_room = Room.current
		Script.run('loot-be-gone2')
		Script.run('go2', start_room.id.to_s)
	end
else
	Script.run('herbmaster',"in #{Vars.herbsack}")
	start_room = Room.current
	Script.run('herbheal')
	Script.run('go2', start_room.id.to_s)
end

#Script.run('waggle')
if Char.prof == 'Cleric' or 'Wizard'
	Script.run('waggle',"#{Vars.spellall}")
end

if Char.name == 'Alastir'
	#Script.run('logic')
end


