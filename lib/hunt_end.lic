#hunt_end.lic
=begin

Author: Alastir

Variables used:
Vars.lootsack
Vars.gemsack -- Where to pull gems.
Vars.storage -- Where to place gems. (bookcase)
Vars.statue_storage -- Where to place statues. (shelves)

=end

if $frontend == 'stormfront'
	$fam_window_begin = "<pushStream id=\"announcements\" ifClosedStyle=\"watching\"/>"
	$fam_window_end   = "<popStream/>\r\n"
else
	$fam_window_begin = "\034GSe\r\n"
	$fam_window_end   = "\034GSf\r\n"
end

def enhancive_remove
	puts("#{$fam_window_begin}-- Removing enhancives.\r\n#{$fam_window_end}")
	Script.run('enhancive','remove')
end

def process_loot
	Script.run('foreach', [ "gem in my #{Vars.gemsack};get item;put item in #{Vars.storage}" ])
	Script.run('foreach', [ "name=small statue in my #{Vars.lootsack};get item;put item on #{Vars.statue_storage}" ])
	Script.run('foreach', [ "type=collectible in my #{Vars.lootsack};get item;put item in desk" ])
	Script.run('foreach', [ "type=herb in my #{Vars.lootsack};get item;put item in desk" ])	
end

##### MAIN LOOP

fput 'store all'

if Room.current.id == 26833 		#[Journey's End, Study]
	if Char.name == 'Alastir'
		if GameObj.right_hand.noun or GameObj.left_hand.noun == 'reins'
			fput 'put my reins in my harness'
		end
		enhancive_remove
	end
	if Char.name == 'Devereux'
		enhancive_remove
	end
	Script.run('herbmaster','in desk')
	start_room = Room.current
	Script.run('herbheal')
	Script.run('go2', start_room.id.to_s)
	Script.run('poolparty')
	process_loot
	Script.run('silvers')
elsif Room.current.id == 29623		#[Estate, Greatroom - 29623]
	if Char.name == 'Devereux'
		fput 'tickle my armor'
		fput 'encumbrance'
	end
	Script.run('herbmaster',"in #{Vars.herbsack}")
	start_room = Room.current
	Script.run('herbheal')
	Script.run('go2', start_room.id.to_s)
	if percentencumbrance >= 10
		Script.run('poolparty')
		start_room = Room.current
		Script.run('loot-be-gone2')
		Script.run('go2', start_room.id.to_s)
	end
else
	Script.run('herbmaster',"in #{Vars.herbsack}")
	start_room = Room.current
	Script.run('herbheal')
	Script.run('go2', start_room.id.to_s)
end

#Script.run('waggle')
if Char.prof == 'Cleric' or 'Wizard'
	Script.run('waggle',"#{Vars.spellall}")
end

if Char.name == 'Alastir'
	#Script.run('logic')
end


