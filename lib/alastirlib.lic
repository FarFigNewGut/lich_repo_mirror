#alastirlib.lic
=begin

Alastirs Library of Goodness!

=end

=begin
--- Lich: auto_group has exited.
--- Lich: uberbarv_d has exited.
--- Lich: spellcaster has exited.
--- Lich: character has exited.
--- Lich: scriptcheck has exited.
--- Lich: log has exited.
--- Lich: auto_sort has exited.
--- Lich: auto_containers has exited.
--- Lich: keepalive_new has exited.
=end

module AlastirLib
  VERSION = '1.0.0'
  def self.version
    Gem::Version.new(VERSION)
  end

	#This module will output messaging.
	module Messaging
	  def self.output(output)
		  if $frontend =~ /stormfront|wrayth/i
		    window_begin = "<pushStream id=\"StringMon\" ifClosedStyle=\"watching\"/>"
			window_end   = "<popStream/>\r\n"
          else
            window_begin = "\034GSe\r\n"
            window_end   = "\034GSf\r\n"
          end
          
		  if $frontend =~ /stormfront|wrayth/i
            puts("#{window_begin}#{output}\r\n#{window_end}")
          end
	  end	
	
	
	end

	#This module will output which spell has been dispelled or has worn off.
	module Spellwatch
		SPELL_INFO = {
				 101 => { "name" => "Spirit Warding I",		"number" => "101" },
				 102 => { "name" => "Spirit Barrier",		"number" => "102" },
				 103 => { "name" => "Spirit Defense", 		"number" => "103" },
				 104 => { "name" => "Disease Resistance",	"number" => "104" },
				 105 => { "name" => "Poison Resistance",	"number" => "105" },
				 107 => { "name" => "Spirit Warding II",	"number" => "107" },
				 112 => { "name" => "Water Walking",		"number" => "112" },
				 120 => { "name" => "Lesser Shroud",		"number" => "120" },
				 140 => { "name" => "Wall of Force",		"number" => "140" },
				 202 => { "name" => "Spirit Shield",		"number" => "202" },
				 204 => { "name" => "Unpresence",			"number" => "204" },
				 207 => { "name" => "Purify Air",			"number" => "207" },
				 211 => { "name" => "Bravery",				"number" => "211" },
				 215 => { "name" => "Heroism",				"number" => "215" },
				 219 => { "name" => "Spell Shield",			"number" => "219" },
				 240 => { "name" => "Spirit Slayer",		"number" => "240" },
				 303 => { "name" => "Prayer of Protection",	"number" => "303" },
				 307 => { "name" => "Benediction",			"number" => "307" },
				 310 => { "name" => "Warding Sphere",		"number" => "310" },
				 313 => { "name" => "Prayer",				"number" => "313" },
				 314 => { "name" => "Relieve Burden",		"number" => "314" },
				 319 => { "name" => "Soul Ward",			"number" => "319" },
				 401 => { "name" => "Elemental Defense I",	"number" => "401" },
				 406 => { "name" => "Elemental Defense II",	"number" => "406" },
				 412 => { "name" => "Weapon Deflect",		"number" => "412" },
				 414 => { "name" => "Elemental Defense III","number" => "414" },
				 425 => { "name" => "Elemental Targetting",	"number" => "425" },
				 430 => { "name" => "Elemental Barrier",	"number" => "430" },
				 503 => { "name" => "Thurfel's Ward",		"number" => "503" },
				 506 => { "name" => "Celerity",				"number" => "506" },
				 507 => { "name" => "Elemental Deflection", "number" => "507" },
				 508 => { "name" => "Elemental Bias",		"number" => "508" },
				 509 => { "name" => "Strength",				"number" => "509" },
				 513 => { "name" => "Elemental Focus",		"number" => "513" },
				 515 => { "name" => "Rapid Fire",			"number" => "515" },
				 520 => { "name" => "Magic Armor",			"number" => "520" },
				 535 => { "name" => "Haste",				"number" => "535" },
				 540 => { "name" => "Temporal Reversion",	"number" => "540" },
				 601 => { "name" => "Natural Colors",		"number" => "601" },
				 602 => { "name" => "Resist Elements",		"number" => "602" },
				 606 => { "name" => "Phoen's Strength",		"number" => "606" },
				 613 => { "name" => "Self Control",			"number" => "613" },
				 617 => { "name" => "Sneaking",				"number" => "617" },
				 618 => { "name" => "Mobility",				"number" => "618" },
				 625 => { "name" => "Nature's Touch",		"number" => "625" },
				 640 => { "name" => "Wall of Thorns",		"number" => "640" },
				 704 => { "name" => "Phase",				"number" => "704" },
				 712 => { "name" => "Cloak of Shadows",		"number" => "712" },
				 716 => { "name" => "Pestilence",			"number" => "716" },
				 902 => { "name" => "Minor Elemental Edge", "number" => "902" },
				 905 => { "name" => "Prismatic Guard",		"number" => "905" },
				 909 => { "name" => "Tremors",				"number" => "909" },
				 911 => { "name" => "Mass Blur",			"number" => "911" },
				 913 => { "name" => "Melgorehn's Aura",		"number" => "913" },
				 917 => { "name" => "Elemental Fury",		"number" => "919" },
				 919 => { "name" => "Wizard's Shield",		"number" => "919" },
				1003 => { "name" => "Fortitude Song",		"number" => "1003" },
				1007 => { "name" => "Kai's Song",			"number" => "1007" },
				1010 => { "name" => "Song of Valor",		"number" => "1010" }, 
				1019 => { "name" => "Song of Mirrors",		"number" => "1019" },
				1109 => { "name" => "Empathic Focus",		"number" => "1109" },
				1119 => { "name" => "Strength of Will",		"number" => "1119" },
				1125 => { "name" => "Troll's Blood",		"number" => "1125" },
				1130 => { "name" => "Intensity",			"number" => "1130" },
				1204 => { "name" => "Foresight",			"number" => "1204" },
				1601 => { "name" => "Mantle of Faith",		"number" => "1601" },
				1603 => { "name" => "Faith's Clarity",		"number" => "1603" },
				1605 => { "name" => "Arm of the Arkati",	"number" => "1605" },
				1606 => { "name" => "Dauntless",			"number" => "1606" },
				1609 => { "name" => "Divine Shield",		"number" => "1609" },
				1610 => { "name" => "Higher Vision",		"number" => "1610" },
				1611 => { "name" => "Patron's Blessing",	"number" => "1611" },
				1612 => { "name" => "Champion's Might",		"number" => "1612" },
				1613 => { "name" => "Guard the Meek",		"number" => "1613" },
				1617 => { "name" => "Zealot",				"number" => "1617" },
				1619 => { "name" => "Faith Shield",			"number" => "1619" },
				1708 => { "name" => "Mystic Impedance",		"number" => "1708" },
				1712 => { "name" => "Spirit Guard",			"number" => "1712" },
			}
	
	  def self.active(name, number)
		  if $frontend =~ /stormfront|wrayth/i
		    window_begin = "<pushStream id=\"StringMon\" ifClosedStyle=\"watching\"/>"
			window_end   = "<popStream/>\r\n"
          else
            window_begin = "\034GSe\r\n"
            window_end   = "\034GSf\r\n"
          end
          
		  if $frontend =~ /stormfront|wrayth/i
            puts("#{window_begin}(#{number}) #{name} - is active!\r\n#{window_end}")
          end
	  end
	  def self.active_spell_lookup(spell)
	    #echo "spell #{spell}"
		name = SPELL_INFO.fetch(spell)["name"]
		#echo "name #{name}"
		number = SPELL_INFO.fetch(spell)["number"]
		#echo "number #{number}"
		self.active(name, number)
	  end

	  def self.deactive(name, number)
		  if $frontend =~ /stormfront|wrayth/i
		    window_begin = "<pushStream id=\"StringMon\" ifClosedStyle=\"watching\"/>"
			window_end   = "<popStream/>\r\n"
          else
            window_begin = "\034GSe\r\n"
            window_end   = "\034GSf\r\n"
          end
          
		  if $frontend =~ /stormfront|wrayth/i
            puts("#{window_begin}(#{number}) #{name} - is gone!\r\n#{window_end}")
          end
	  end
	  def self.deactive_spell_lookup(spell)
	    #echo "spell #{spell}"
		name = SPELL_INFO.fetch(spell)["name"]
		#echo "name #{name}"
		number = SPELL_INFO.fetch(spell)["number"]
		#echo "number #{number}"
		self.deactive(name, number)
	  end
    
    def self.initialize
      _respond("<closeDialog id='StringMon'/><streamWindow id='StringMon' title='Messaging' location='left' resident='true'></streamWindow>")    
    end

    self.initialize
  end
end

#A triton warden is revealed from hiding.
#The pale driftwood arrow cracks and splinters, scattering a few strands of lichen about the area.

#A streaked pale driftwood arrow flies out of the shadows toward you!
#  AS: +431 vs DS: +655 with AvD: +29 + d100 roll: +94 = -101
#   A clean miss.
#The pale driftwood arrow cracks and splinters, scattering a few strands of lichen about the area.