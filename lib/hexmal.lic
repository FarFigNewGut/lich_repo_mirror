=begin
Calculate your Maximum Animatable Level (MAL)

Based on:
MAL = (700s ranks, capped at level) - 10
    + (700s ranks over level / 10, max of 5)
    + (WIS Bonus / 5)
    + (Sorcerous Lore, Necromancy Ranks / 10)
=end

begin
  # --- Pull core data ---

  # Your level
  level = Stats.level

  # Wisdom bonus (enhanced)
  wisdom = Stats.wisdom.enhanced.bonus

  # Total Sorcerer circle ranks (700s)
  sorcspells = Spells.sorcerer

  # Sorcerous Lore, Necromancy ranks
  necro_ranks = Skills.slnecromancy

  # --- MAL formula pieces ---

  # (700s ranks, capped at level)
  capped_700 = [sorcspells, level].min

  # (700s ranks over level)
  over_700 = [sorcspells - level, 0].max

  # (700s ranks over level / 10, max of 5)
  over_700_bonus = over_700 / 10
  over_700_bonus = 5 if over_700_bonus > 5

  # (WIS Bonus / 5)
  wis_term = wisdom / 5

  # (Sorcerous Lore, Necromancy Ranks / 10)
  necro_term = necro_ranks / 10

  # Final MAL
  mal = capped_700 - 10 + over_700_bonus + wis_term + necro_term

  # --- Pretty output ---

  respond "===== Maximum Animatable Level (MAL) ====="
  respond "Level:                                #{level}"
  respond "700s ranks (Sorcerer circle):         #{sorcspells}"
  respond "  - Capped at level:                  #{capped_700}"
  respond "700s ranks over level:                #{over_700}"
  respond "  -> Over-level bonus (/10, max 5):   #{over_700_bonus}"
  respond "Wisdom bonus:                         #{wisdom}"
  respond "  -> WIS term (bonus / 5):            #{wis_term}"
  respond "Sorcerous Lore, Necromancy ranks:     #{necro_ranks}"
  respond "  -> Necromancy term (ranks / 10):    #{necro_term}"
  respond "-------------------------------------------"
  respond "Maximum Animatable Level (MAL):        #{mal}"
  respond "==========================================="
rescue => e
  respond "MAL script error: #{e.class} - #{e.message}"
end
