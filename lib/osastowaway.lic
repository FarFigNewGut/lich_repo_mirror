=begin
	This is a companion to osacommander. It is ran by those who do not wish to do any roles on the ship. 
It will simply get OSA tasks and deposit coins in the bank to keep encumbrance down.  
Simply start the script with your commanders name e.g: ;osastowaway Peggyanne
Enjoy

~Peggyanne
PS: feel free to send me any bugs via discord Bait#4376 and I'll try my best to fix them.
10/06/2021 Initial Release, Supports All Ship Types
=end

spellup = proc{
start_script "waggle"
wait_while { running?("waggle") }
do_client ";chat to #{variable[1]} Task Complete"
if !running? 'sharetest'
start_script 'sharetest'
end
waitfor /This spell up party is finished/
pause 0.5
Script.kill "sharetest"
}

give_coins = proc{
	wealth_line = dothistimeout "wealth quiet", 1, /coins? with you.$/
	@coins = wealth_line.match(/([0-9,]+)/)[1].sub(/[^0-9]/, '').to_i
	if  @coins = 0
	else
	fput "give #{Vars.commander} #{@coins} coins"
	end
}

statuscheck = proc{
	do_client ";chat on #{variable[1]} Health: #{health}/#{maxhealth}     Mana: #{mana}/#{maxmana}     Stamina: #{stamina}/#{maxstamina}     Spirit: #{spirit}/#{maxspirit}"
	next
}

expcheck = proc{
@exptnl = XMLData.next_level_text.to_i
@nextlevel = (Stats.level.to_i + 1)
do_client ";chat on #{variable[1]} Exp Till Level #{@nextlevel} Is: #{@exptnl}"
}

checkexp = proc{
result = dothistimeout "osa task", 1, /You do not currently have a task from the Sea Hag's Roost|You should return to the Sea Hag's Roost to report your success|Abandons your current task/
    if result =~ /You do not currently have a task from the Sea Hag's Roost/
		fput "take board"
		pause 0.5
		do_client ";chat to #{variable[1]} Task Complete"
	elsif result =~ /You should return to the Sea Hag's Roost to report your success/
		if saturated?
			wait_until {!saturated?}
				end
		fput "turn board"
		pause 0.5
		fput "take board"
		pause 0.5
		do_client ";chat to #{variable[1]} Task Complete"
	elsif result =~ /Abandons your current task/
		do_client ";chat to #{variable[1]} Task Complete"
	else
		do_client ";chat to #{variable[1]} Task Complete"
    end
}

if variable[1].downcase =~ /help/
	echo "
	
	This is a companion to osacommander. It is ran by those who do not wish to do any roles on the ship. 
It will simply get OSA tasks and deposit coins in the bank to keep encumbrance down.  
Simply start the script with your commanders name e.g: ;osastowaway Peggyanne
Enjoy

~Peggyanne
PS: feel free to send me any bugs via discord Bait#4376 and I'll try my best to fix them.
10/06/2021 Initial Release, Supports All Ship Types"
exit
end
if variable[1].downcase =~ /call/
(eval variable[2]).call
else
while line = get
case line
when /^\[#{variable[1]}]-GSIV:#{variable[1]}\: \"Silvers\"$/
give_coins.call
when /^\[#{variable[1]}]-GSIV:#{variable[1]}\: \"Status\"$/
statuscheck.call
when /^\[#{variable[1]}]-GSIV:#{variable[1]}\: \"Spells\"$/
spellup.call
when /^\[#{variable[1]}]-GSIV:#{variable[1]}\: \"Exp\"$/
expcheck.call
when /^\[#{variable[1]}]-GSIV:#{variable[1]}\: \"Task Time!\"$/
checkexp.call
when /^\[#{variable[1]}]-GSIV:#{variable[1]}\: \"Deposit\"$/
fput "depo all"
when /^\[#{Vars.crew}]-GSIV:#{Vars.commander}\: \"Quarters! All Hands To Quarters For Muster, Instruction and Inspection!\"$/
		do_client ";chat to #{Vars.commander} Passenger #{checkname} Present Captain!"
end
end
end