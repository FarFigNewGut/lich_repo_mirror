#hunt_begin.lic
=begin

Author: Alastir

=end

Script.run('repository', 'set-updatable hunt_begin.lic')

if $frontend == 'stormfront'
	$fam_window_begin = "<pushStream id=\"announcements\" ifClosedStyle=\"watching\"/>"
	$fam_window_end   = "<popStream/>\r\n"
else
	$fam_window_begin = "\034GSe\r\n"
	$fam_window_end   = "\034GSf\r\n"
end

def enhance_wear
	puts("#{$fam_window_begin}-- Wearing enhancives.\r\n#{$fam_window_end}")
	Script.run('enhance','wear')
end

def miu
	puts("#{fam_window_begin}-- Checking to see if Magical Item Spells are active.\r\n#{fam_window_end}")
	Script.run ('miu')
end

def teleport
	waitrt?
	result = checkbounty
	if result =~ /You have been tasked to suppress bandit activity/
		if Char.name == 'Alastir'
			$mount_active = false
		end
		enhance_wear
		fput 'gird'
	elsif result =~ /You are not currently assigned a task/
		to_OTF
	elsif result =~ /You succeeded in your task/
		to_OTF
	elsif result =~ /You have succeeded in your task/
		to_OTF
	elsif result =~ /The herbalist's assistant in Ta'Illistim/
		to_OTF
	elsif result =~ /The local gem dealer/
		to_OTF
	elsif result =~ /You have been tasked to suppress/
		to_OTF
	elsif result =~ /You have been tasked to hunt down and kill/
		to_OTF
	elsif result =~ /A certain client has hired us to provide a protective escort/
		to_OTF
	elsif result =~ /You have been tasked to recover/
		to_OTF
	elsif result =~ /You have located/
		to_OTF
	else
	end
end

def to_OTF
#	echo 'This is gird calling to_OTF'
	if Char.name == 'Alastir'
		#Call stallion, teleport to OTF
		multifput 'get my reins','wave my reins','mount stallion','mount travel hunt 20','mount travel hunt 20'
		waitfor 'You ease the reins of your white stallion as you canter toward your destination.'
		multifput 'dismount','put my reins in my harness'
		$mount_active = true
		enhance_wear
	elsif Char.name == 'Devereux'
		enhance_wear
	else
		fput 'urchin guide citygate'
	end
	sleep 0.1
	waitrt?
end

def teleport_to_willow
	pause_script('go2') if Script.running?('go2')
	if Char.name == 'Alastir'
		waitrt?
		multifput 'get my veil amulet from my harness','wear my veil amulet'
			fput "twist my #{Vars.teleporter} to 0"
			fput "rub my #{Vars.teleporter}"
		multifput 'remove my veil amulet','put my veil amulet in my harness'
		sleep 0.1
	elsif Char.name == 'Erykk'
		waitrt?
		sleep 0.1
	elsif Char.name == 'Devereux'
		waitrt?
		sleep 0.1
	elsif Char.name == 'Rylohk'
		waitrt?
		sleep 0.1
	end
	kill_script('go2') if Script.running?('go2')
end

##### MAIN LOOP

pause_script 'bountyhunter'
if Room.current.id == 26906 			#Journey's End, Willow
	miu
	teleport							
elsif Room.current.id == 26833 			#Journey's End, Study
	Script.run('go2','26906') 			#Willow	
	miu
	teleport							
elsif Room.current.id == 37				#Ta'Illistim - AdvGuard
	teleport_to_willow
	miu
	teleport							
elsif Room.current.id == 11968 			#OTF Tiny Cottage
	enhance_wear
else
end

fput 'gird'
unpause_script 'bountyhunter'
	
