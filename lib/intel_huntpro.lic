=begin
|0-100 Hunting Script - Please do not AFK Script in Prime.|

Please adhere to POLICY 18.

Usage: ;huntpro stylenumber areastring

Huntpro Help: http://tinyurl.com/huntprohelp
	
Huntpro Feedback: https://discord.gg/NEX6B5DFCX

YouTube: http://tinyurl.com/gsivjara

Email: Jara@play.net
|---------------------------------------------------------|
=end

#Hide Command Inputs
silence_me


#OOP

module Intel_huntpro_toolkit

	def intel_huntpro_feedback
		
		respond
		respond "Hello #{Char.name}, I'm Intel Huntpro."
		respond
		
	end
	
	def top_menu
		respond "|0-100 Hunting Script - Please do not AFK Script in Prime.|"
		respond
	end
	
	def bottom_menu
		respond
		respond "|---------------------------------------------------------|"
	end
	
end

include Intel_huntpro_toolkit


intel_huntpro_kill_scripts = proc {


Script.kill "#{$huntpro_script_one}" if Script.running? "#{$huntpro_script_one}"
Script.kill "#{$huntpro_script_two}" if Script.running? "#{$huntpro_script_two}"
Script.kill "#{$huntpro_script_three}" if Script.running? "#{$huntpro_script_three}"

Script.kill "child2" if Script.running? "child2"
Script.kill "song-manager" if Script.running? "song-manager"
Script.kill "symbolz" if Script.running? "symbolz"
Script.kill "isigns" if Script.running? "isigns"
Script.kill "isigils" if Script.running? "isigils"
Script.kill "reactive" if Script.running? "reactive"

}

#########################################
#########################################

#Start of Script

#########################################
#########################################


#New User & Update - DO NOT REMOVE

if script.vars[1].downcase =~ /update_all/

	Script.run('repository', 'download huntpro.lic')
	Script.run('repository', 'download intel_huntpro.lic')
	if Script.exists? "sloot"
		nil
	else
		Script.run('repository', 'download sloot.lic')
		Script.run('repository', 'download sloot.ui')
	end
	Intel_huntpro_toolkit.top_menu
	respond "Hi #{Char.name}, ;huntpro has been updated, please restart the script. Thanks!"
	Intel_huntpro_toolkit.bottom_menu
	Script.kill "huntpro"
	Script.kill "intel_huntpro"
	exit
end



loop {

	if Script.running? "huntpro"
		nil
	else
		intel_huntpro_kill_scripts.call
		exit
	end
	
	line = get
	
		if line =~ /obvious signs of someone hiding/
			#respond "Debug Output - Someone is here Obviously."
			$huntpro_action = 98
		end
		
		if line =~ /there is no need to fight/
			#respond "Debug Output - Sancted."
			$huntpro_action = 98
		end			
		
		if line =~ /no need for spells of war/
			#respond "Debug Output - Sancted."
			$huntpro_action = 98
		end
		
		if line =~ /disruption of the noise in the area causes the spell to fizzle/
			#respond "Debug Output - Song of Noise"
			$huntpro_action = 98
		end
		
		
	
		if line =~ /You will have to stand up first/
			until checkstanding
				fput "stand"
				sleep 0.5
			end
		end
		
		if line =~ /You rub your chin/
			$huntpro_consider_setup = "1"
		end
		
		if line =~ /the RECOVER ITEM command/
			$huntpro_lost_item = Room.current.id
			$huntpro_action = 99
			$huntpro_return_why = "You lost an item in room #{$huntpro_lost_item}. Return there, kneel and use RECOVER ITEM."
		end
		
		
		
		if $huntpro_group_ai == "0"
			nil
		else
			#Things do capture in a group.
			
			if line =~ /\: \"(.*) EMPATH\"/
				$huntpro_group_empath = $1
			end
			
		
			if checkdead
				do_client ";chat to #{$huntpro_captain} Dead"
				Script.kill "huntpro"
				intel_huntpro_kill_scripts.call
				exit
			end
			
			if line =~ /appears less confident/
				$huntpro_group_upkeep211 = "0"
			end
			
			if line =~ /brilliant aura fades away/
				$huntpro_group_upkeep215 = "0"
			end
			
			if line =~ /"(.*) please heal us\.\"/
			
				if $huntpro_group_support == "0"
					nil
				else
					if $huntpro_group_empath == "#{Char.name}"
						#respond "I am the healer and I'm healing you now."
							if Script.exists? "heal"
									nil
							else
								Script.run('repository', 'download heal.lic')													
							end
							
							if Script.exists? "selfhealall"
									nil
							else
								Script.run('repository', 'download selfhealall.lic')													
							end
								Spell[213].cast() if Spell[213].known? && Char.level >= 13 && Spell[213].affordable?
								waitcastrt?
								sleep 1
								#Thanks to Darkcipher for making ;unstun.  This routine is a slightly modified version of it.
								if(!checkstunned && !checkdead && players = GameObj.pcs)
									players.each do |p|
									waitcastrt?
									
									#Heal People
									
									result = dothistimeout "trans " + p.noun + " any", 3, /could not find any|feel some of your|Roundtime/
										if result =~ /could not find any/
											nil
										elsif result =~ /feel some of your|Roundtime/
											$huntpro_current_patient = "0"
											$huntpro_current_patient = "#{p.noun}"
											waitrt?
											sleep 0.1
											fput "trans " + p.noun
											fput "cure"
											waitcastrt?
											waitrt?
											do_client ";heal #{$huntpro_current_patient}"
											sleep 5
											if Script.running? "heal"
												Script.kill "heal"
											end

										end
									
										
									end
									pause 0.5
								end
								pause 1
						
						Script.run('selfhealall')
						fput "stop 213"
						do_client ";chat to #{$huntpro_captain} RESUME"
					end
				end
			end
		end
		
		
		
		if line =~ /"#{$huntpro_group_empath} help\, (.*) diseased\.\"/
			#respond "Debug Output - Detected someone is poisoned."
			if $huntpro_group_support == "0"
				nil
			else
				$huntpro_group_diseased = $1
				if Spell[113].known? && Spell[113].affordable? && Char.level >= 13
					fput "release"
					fput "prep 113"
					fput "cast #{$huntpro_group_diseased}"
					waitcastrt?
					sleep 3
				end
				do_client ";chat to #{$huntpro_captain} RESUME"
			end
			
		end
		
		
		if line =~ /"#{$huntpro_group_empath} help\, (.*) poisoned\.\"/
			#respond "Debug Output - Detected someone is poisoned."
			if $huntpro_group_support == "0"
						nil
			else
				$huntpro_group_poisoned = $1
				if Spell[114].known? && Spell[114].affordable? && Char.level >= 14
					fput "release"
					fput "prep 114"
					fput "cast #{$huntpro_group_poisoned}"
					waitcastrt?
					sleep 3
				end
				do_client ";chat to #{$huntpro_captain} RESUME"
			end
			
		end
		
		
		if line =~ /"(.*) MANA\.\"/
			$huntpro_group_mana_target = $1
			SLICE = (checkmana * 0.25)
			waitcastrt?
			waitrt?
			fput "send #{SLICE.round(0)} #{$huntpro_group_mana_target}"	
			
			
		end
		
		
		
		#Traps for the group leader.  You can delegate new features here.
		if $huntpro_group_ai == "1"
			if line =~ /\: \"Dead\"/
				$huntpro_recent_death = "1"
				$huntpro_action = 99
				$huntpro_return_why = "A member of your group has died."
			elsif line =~ /\: \"RESUME\"/
				Script.unpause('huntpro')
			end
			
			if line =~ /\: \"I\'m injured\"/
				if $huntpro_group_empath == "0"
					nil
				else
					Script.pause('huntpro')
					fput "whisper group #{$huntpro_group_empath} please heal us."
				end
				
			elsif line =~ /\: \"Low Health"/
			
				if $huntpro_group_empath == "0"
					nil
				else
					Script.pause('huntpro')
					fput "whisper group #{$huntpro_group_empath} please heal us."
				end
				
			elsif line =~ /\: \"(.*) is diseased\"/
				$huntpro_group_diseased = $1
				if $huntpro_group_empath == "0"
					nil
				else
					Script.pause('huntpro')
					fput "whisper group #{$huntpro_group_empath} help, #{$huntpro_group_diseased} diseased"
					sleep 0.5
				end
			elsif line =~ /\: \"(.*) is poisoned\"/
				$huntpro_group_poisoned = $1
				if $huntpro_group_empath == "0"
					nil
				else
					Script.pause('huntpro')
					fput "whisper group #{$huntpro_group_empath} help, #{$huntpro_group_poisoned} poisoned"
					sleep 0.5
				end
			elsif line =~ /\: \"(.*) needs MANA\"/
				if $huntpro_group_sharemana == "0"
					nil
				else
					$huntpro_group_mana_target = $1 
					waitrt?
					waitcastrt?
					SLICE = (checkmana * 0.25)
					waitcastrt?
					waitrt?
					fput "send #{SLICE.round(0)} #{$huntpro_group_mana_target}"	
					fput "whisper group #{$huntpro_group_mana_target} MANA"
					sleep 0.5
				end

			
			end			
		end
		
		#Things the group followers will look for.
		if $huntpro_group_ai == "2"
			if line =~ /#{$huntpro_captain}\'s player whispers to the group\, \"End\.\"/
			
				Script.kill "#{$huntpro_script_one}" if Script.running? "#{$huntpro_script_one}"
				Script.kill "#{$huntpro_script_two}" if Script.running? "#{$huntpro_script_two}"
				Script.kill "#{$huntpro_script_three}" if Script.running? "#{$huntpro_script_three}"
				
				Script.kill "isigns" if Script.running? "isigns"
				Script.kill "isigils" if Script.running? "isigils"
				Script.kill "symbolz" if Script.running? "symbolz"
				Script.kill "song-manager" if Script.running? "song-manager"
				Script.kill "reactive" if Script.running? "reactive"
				
				Script.kill "huntpro"
					if Script.exists? "waggle"
						do_client ";waggle"
					else
						Script.run('repository', 'download waggle.lic')
						do_client ";waggle"
					end
				intel_huntpro_kill_scripts.call
				exit
			
			end
			
			if line =~ /#{$huntpro_captain}\'s player whispers to the group\, \"We are hunting in a level (.*) Zone\.\"/
				$huntpro_my_area_level = $1
			end
			
			if line =~ /#{$huntpro_captain}\'s player whispers to the group\, \"Prepare for (.*) creatures\.\"/
				$huntpro_my_area_type = $1
			end
			
		end
	
	
		if line =~ /but it has no effect|your attack has no effect/
			$huntpro_action = 99
			$huntpro_return_why = "You aren't wearing correct equipment to fight this creature. You may need enchanted weapons, armor or ammo."
		end
		
		
		#Caedera Trap
		if line =~ /ground shakes violently as a caedera explodes from the ground/
			nil

		#Boil Trap
		elsif line =~ /burst from the ground|explodes from the ground|earth cracks|icy mist rises from the ground/
			#respond "Debug Output - Intel Boil Trap"
			$huntpro_action = 98
		end	
		
		if line =~ /Accept your fate/
				Script.pause('huntpro')
		end
		
		if line =~ /tossed about like a rag/
				Script.unpause('huntpro')
		end
		
		
		if checkright == "caederine"
			fput "stow right"
		end
		
		if checkleft == "caederine"
			fput "stow left"
		end
		
		#Rifted Check
		
		if line =~ /Suddenly you feel sick and queasy\, and your world seems blurry and indistinct/
			Script.pause('huntpro')
			if $huntpro_my_area =~ /rift1/
				Script.run('go2', '2579')
				pause 1
			elsif $huntpro_my_area =~ /rift2/
				Script.run('go2', '12142')
				pause 1
			elsif $huntpro_my_area =~ /rift3/
				Script.run('go2', '12184')
				pause 1
			elsif $huntpro_my_area =~ /rift4/
				Script.run('go2', '12138')
				pause 1
			elsif $huntpro_my_area =~ /rift5/
				Script.run('go2', '12159')
				pause 1
			elsif $huntpro_my_area =~ /northscatter/
				Script.run('go2', '12219')
				pause 1
			elsif $huntpro_my_area =~ /southscatter/
				Script.run('go2', '12245')
				pause 1
			end
			Script.unpause('huntpro')
		end
		
		#AIM Missing Trap
		
		if line =~ /is already missing that|cannot aim that high/
			Script.pause('huntpro')
			$huntpro_aim_fail = $huntpro_aim_fail + 1
			waitrt?
			sleep 0.5			
			if $huntpro_aim_fail == 1
				fput "aim left leg"
			elsif $huntpro_aim_fail == 2
				fput "aim right leg"
			elsif $huntpro_aim_fail == 3
				fput "aim clear"			
			end			
			Script.unpause('huntpro')
		end
		
		
		#Bounty Support
		
		if $huntpro_bounty_intel_watch == "0"
			nil
		else
			
			#Bounty Forks
			
			if line =~ /You are eligible for new task assignment/
				$huntpro_bounty_stage = "1"	
				$huntpro_bounty_type = "Eligible"
			end
			
			if line =~ /You will be eligible for new task assignment/
				$huntpro_bounty_stage = "8"
				$huntpro_bounty_type = "Not Eligible"
			end
			
			if line =~ /probably can\'t help you if (she|he) can't see you/
				Intel_huntpro_toolkit.top_menu
				respond "#{Char.name}, you are invisible.  Please UNHIDE.  After doing so, restart Huntpro Bounty feature."
				#respond "#{Char.name}, we're about to do bandits."
				#respond "Use ;ua to begin or ;ka to do your own thing."
				Intel_huntpro_toolkit.bottom_menu
				Script.kill "huntpro"
				intel_huntpro_kill_scripts.call
				exit
				
			end
			
			
			#Trap Bounty Type
			
			if line =~ /provide a protective escort/
				$huntpro_bounty_type = "Escort"
				Intel_huntpro_toolkit.top_menu
				respond "#{Char.name} - Escort Bounties Disabled Currently."
				#respond "#{Char.name}, we're about to do bandits."
				#respond "Use ;ua to begin or ;ka to do your own thing."
				Intel_huntpro_toolkit.bottom_menu
				Script.kill "huntpro"
				intel_huntpro_kill_scripts.call
				exit
							
			end
			
			if line =~ /some kind of lost heirloom/
				$huntpro_bounty_type = "Heirloom"
				$huntpro_bounty_stage = "4"
							
			end

			if line =~ /and LOOT the item/
				$huntpro_bounty_type = "Heirloom"
				$huntpro_bounty_heirloom_type = "LOOT"
							
			end
			
			if line =~ /SEARCH the area/
				$huntpro_bounty_type = "Heirloom"
				$huntpro_bounty_heirloom_type = "SEARCH"
				Intel_huntpro_toolkit.top_menu
				respond "#{Char.name} - This is a SEARCH bounty."
				respond
				respond "Head out to the creature area, stow all, kneel and search."
				respond
				respond "You should move rooms every search.  Use 3-4 rooms for best results."
				Intel_huntpro_toolkit.bottom_menu
				Script.kill "huntpro"
				intel_huntpro_kill_scripts.call
				exit
							
			end
			
			
			if line =~ /have a bandit problem/
				$huntpro_bounty_type = "Bandit"
				$huntpro_bounty_stage = "4"
				#Script.pause('huntpro')
				Intel_huntpro_toolkit.top_menu
				respond "#{Char.name} - Bandit Setting Disabled Currently."
				#respond "#{Char.name}, we're about to do bandits."
				#respond "Use ;ua to begin or ;ka to do your own thing."
				Intel_huntpro_toolkit.bottom_menu
				Script.kill "huntpro"
				intel_huntpro_kill_scripts.call
				exit				
			end
			
		
			if line =~ /suppress bandit activity/
				$huntpro_bounty_type = "Bandit"
				$huntpro_bounty_stage = "5"
				$huntpro_my_area = "bandit"				
				
			end
			
			if line =~ /a creature problem they\'d like you to solve/
				$huntpro_bounty_stage = "4"
				$huntpro_bounty_type = "creature"
			end
			
			if line =~ /local resident urgently needs/
				$huntpro_bounty_type = "child"

			end
			
			if line =~ /local herbalist\'s assistant\, Kelph|herbalist\'s assistant in Solhaven\, Kelph/
				$huntpro_bounty_type = "herbs"
				$huntpro_bounty_stage = "4.75"
			end
			
			
			
			
			if line =~ /local furrier Furryback has an order/
				$huntpro_bounty_stage = "4.5"
				$huntpro_bounty_type = "skin"
			end
			
			#If you start bounty over traps
			
			if line =~ /Furryback in Icemule/
				$huntpro_bounty_type = "skin"
				$huntpro_bounty_stage = "5"
			end			
			
			if line =~ /child fleeing from/
				$huntpro_bounty_type = "child"
				$huntpro_bounty_stage = "5"
			end			

			
			if line =~ /local gem dealer/
				Script.pause('huntpro')
				$huntpro_bounty_type = "gem"
				do_client ";go2 gemshop"
				wait_while {running? "go2"}
				Intel_huntpro_toolkit.top_menu
				respond "#{Char.name}, you have a gem bounty.  I'll let you handle it from here."
				Intel_huntpro_toolkit.bottom_menu
				Script.kill "huntpro"
				intel_huntpro_kill_scripts.call
				exit
				
			end
			
			
			#Creature matches
			
			#Landing/
			
			if line =~ /lesser ghoul in the Graveyard near Wehnimer\'s Landing/
				$huntpro_bounty_creature_name = "ghoul"
				$huntpro_creature_sev_1_attack_array = nil
				$huntpro_creature_sev_1_attack_array = [ "lesser ghoul" ]				
				$huntpro_my_area = "wlghoul"	
				$huntpro_bounty_stage = "5"
			end
			
			if line =~ /a rolton in the Lower Dragonsclaw/
				$huntpro_bounty_creature_name = "rolton"
				$huntpro_creature_sev_1_attack_array = nil
				$huntpro_creature_sev_1_attack_array = [ "rolton" ]
				$huntpro_my_area = "wlrolton"	
				$huntpro_bounty_stage = "5"				
			end
			
			#Solhaven
			
			if line =~ /a rotting corpse in Castle Varunar/
				$huntpro_bounty_creature_name = "rotting corpse"
				$huntpro_creature_sev_1_attack_array = nil
				$huntpro_creature_sev_1_attack_array = [ "rotting corpse" ]
				$huntpro_my_area = "solcorpse"	
				$huntpro_bounty_stage = "5"				
			end
			
			if line =~ /by an eidolon in Bonespear Tower/
				$huntpro_bounty_creature_name = "eidolon"
				$huntpro_creature_sev_1_attack_array = nil
				$huntpro_creature_sev_1_attack_array = [ "eidolon" ]
				$huntpro_my_area = "soldybbuk"	
				$huntpro_bounty_stage = "5"				
			end
			
			
			
			#Icemule
			#Pinefar
			#Rift
			
			if line =~ /by a n\'ecare in the Rift/
			
				$huntpro_bounty_creature_name = "n\'ecare"
				$huntpro_creature_sev_1_attack_array = nil
				$huntpro_creature_sev_1_attack_array = [ "n\'ecare" ]
				$huntpro_my_area = "rift3"
				$huntpro_bounty_type = "creature"
				$huntpro_bounty_stage = "5"
			end
			
			if line =~ /darkly inked fetish master activity in the Rift/
			
				$huntpro_bounty_creature_name = "master"
				$huntpro_creature_sev_1_attack_array = nil
				$huntpro_creature_sev_1_attack_array = [ "darkly inked fetish master" ]
				$huntpro_my_area = "northscatter"
				$huntpro_bounty_type = "creature"
				$huntpro_bounty_stage = "5"
			end
			
			if line =~ /enormous rift crawler activity in the Rift/
			
				$huntpro_bounty_creature_name = "crawler"
				$huntpro_creature_sev_1_attack_array = nil
				$huntpro_creature_sev_1_attack_array = [ "enormous rift crawler" ]
				$huntpro_my_area = "rift4"
				$huntpro_bounty_type = "creature"
				$huntpro_bounty_stage = "5"
			end
			
			if line =~ /fallen crusader activity/
			
				$huntpro_bounty_creature_name = "fallen crusader"
				$huntpro_creature_sev_1_attack_array = nil
				$huntpro_creature_sev_1_attack_array = [ "fallen crusader" ]
				$huntpro_my_area = "rift4"
				$huntpro_bounty_type = "creature"
				$huntpro_bounty_stage = "5"
			end
			
			if line =~ /glistening cerebralite activity in the Rift/
			
				$huntpro_bounty_creature_name = "cerebralite"
				$huntpro_creature_sev_1_attack_array = nil
				$huntpro_creature_sev_1_attack_array = [ "glistening cerebralite" ]
				$huntpro_my_area = "rift4"
				$huntpro_bounty_type = "creature"
				$huntpro_bounty_stage = "5"
			end			
			
			if line =~ /retrieve (.*) barbed cerebralite tentacles/
				$huntpro_bounty_creature_name = "cerebralite"
				$huntpro_creature_sev_1_attack_array = nil
				$huntpro_creature_sev_1_attack_array = [ "glistening cerebralite" ]
				$huntpro_my_area = "rift4"	
				$huntpro_bounty_type == "skin"
				$huntpro_combat_cleanup = "1"
			end
			
			
			#Combat Matches
			
			if line =~ /Out of the corner of your eye|made contact with the child/
				Script.pause('huntpro')
				if Script.exists? "step2"
					nil
				else
					Script.run('repository', 'download step2.lic')
				end
				
				if Script.exists? "child2"
					nil
				else
					Script.run('repository', 'download child2.lic')
				end
				
				do_client ";child2"
				
			end
			
			if line =~ /You may return to the Adventurer's Guild|may pick up your reward there|You have completed this portion of your Adventurer\'s Guild task|looks like the heirloom that you are searching for/
				#Reload Huntpro to collect reward.
				Script.kill "huntpro"
				Script.run "#{$huntpro_loot_script}"
				if Script.running? "child2"
					Script.kill "child2"
				end
				do_client ";huntpro #{$huntpro_my_style} bounty"
				exit
			end
			
			if line =~ /You have succeeded in your task and can return to the Adventurer\'s Guild/
				
				$huntpro_bounty_stage = "7"
			
			end
			
			if line =~ /report back to one of the Icemule Trace gate/
				
				$huntpro_bounty_stage = "4"
			
			end
			
			if line =~ /and should bring it back to/
				
				$huntpro_bounty_stage = "4.25"
				$huntpro_bounty_type = "Heirloom"
			
			end
			
			if line =~ /don\'t see it in your hands/
				
				Script.kill "huntpro"
				Intel_huntpro_toolkit.top_menu
				respond "#{Char.name}, you seem to be done with your heirloom bounty but are having trouble getting the heirloom from your #{Vars.lootsack}."
				respond
				respond "Most likely this happens because the heirloom was put in a different container."
				respond
				respond "If you can't find the heirloom item, you might have to abandon this bounty."
				respond
				respond "I'll let you find the item and turn it in.  After doing so, restart Huntpro Bounty feature."
				Intel_huntpro_toolkit.bottom_menu
				Script.kill "huntpro"
				intel_huntpro_kill_scripts.call
				exit
			
			end
			
			
			if line =~ /report to Quin Telaren|report back to one of the/
				$huntpro_bounty_stage = "4"
							
			end
			
						
			if line =~ /You have succeeded in your task and can return to the Adventurer\'s Guild/
				
				$huntpro_bounty_stage = "7"
			
			end
			
			
			
		end
		
	sleep 0.01
	

}