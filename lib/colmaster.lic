=begin

	Master COL in Solhaven!
	
	This script will ask if you want to join COL if you are not already a member of a society. If you wish to join COL then the script will join COL for you.
	
	If you are already a member of the Guardians of Sunfist or the Order of Voln and wish to join COL you have to first leave your current society then run this script.
	
	Script will seek out the Matron in Solhaven, join COL, and get busy mastering COL for you. All automagically!
	
	Script will not gather skins or flowing white robes but will turn them in automatically if you have them in an open container. Script will also tell you which critters you need to skin to fulfil your skinning task and which lich rooms they can be found in.	
	
	Script will handle every other task all on its own! Amazing!
	
	Special thanks to Lord Flessen for his script "colanswers" where I got most of the questions and answers from.
	
	NOTE: While all answers to the Inquisitor's questions appear to be in the script, in some cases the script doesn't have the exact wording of the question right so it might hang up sometimes in the Inquisitor's room. If this happens you can try to find the correct answer within this script by searching for keywords of the question. Also please send the exact question to Tgo01 on the PC forums or message them to Dreaven in game so I can correct the problem in the script.

	########################################################
	Ways to contact me:
	In game: Dreaven
	Player's Corner: Tgo01
	Discord: Dreaven#6436
	Email: LordDreaven@gmail.com
	If you like my scripts feel free to send me a tip via Paypal at: LordDreaven@gmail.com
	########################################################
	
	Author: Dreaven
	Version: 23

=end

current_task = nil
target_room = nil
total_item_cost = nil
number_of_items = nil
item_name = nil
item_cost = nil
item_order_number = nil
message_to_say = nil

answers = {

	'Where can you find Rolly Siphter'																													=> { :a => "Bakery" },
	'What are the swans doing in front of the temple'																									=> { :a => "kissing" },
	'What race does Rolly belong to'																													=> { :a => "Halfling" },
	'(What colou?r eyes does Rolly have|a metal prized by the Vaalor elves)'																				=> { :a => "Blue" },
	'How many different cakes can you buy from the baker'																								=> { :a => "Four" },
	'What colou?r hair does Holly have'																													=> { :a => "Auburn" },
	'(Where can you buy thrak hide boots|From whose shop can you purchase Thrak\-hide boots|Who is the cobbler of Solhaven)'							=> { :a => "Gornissa" },
	'How long has Gornissa owned her shop'																												=> { :a => "Years" },
	'What is Gornissa\'s gown made from'																												=> { :a => "Muslin" },
	'The pawnbroker\'s last name is'																													=> { :a => "Gryhm" },
	'(Who is the weaponsmith|What is the weaponsmith\'s name)'																							=> { :a => "Marsaena" },
	'Marsaena is a member of the'																														=> { :a => "Dwarven" },
	'What does Ayniya carefully dab'																													=> { :a => "Beeswax" },
	'What colou?r gown does Ayniya wear'																													=> { :a => "Green" },
	'What colou?r is Ayniya\'s hair'																													=> { :a => "Chestnut" },
	'The name of the jeweler is'																														=> { :a => "Kahlyr" },
	'What does Kahlyr wear'																																=> { :a => "Gown" },
	'(What is the armourer\'s name|What is the name of the armorer|Where can you get a visored helm|From whose shop can you purchase a visored helm)' 	=> { :a => "Dargeur" },
	'What critter can be found in Dargeur\'s shop'																										=> { :a => "Rat" },
	'What race is Dargeur'																																=> { :a => "Half-Elven" },
	'Dargeur is a member of the'																														=> { :a => "Half-Elven" },
	'What colou?r is Dargeur\'s apron'																													=> { :a => "Off-grey" },
	'What hangs above the armory'																														=> { :a => "Breastplate" },
	'Where can one buy a blackjack'																														=> { :a => "Armory" },
	'Where can you purchase a blackjack'																												=> { :a => "Armory" },
	'From whom can you buy a flask of absinthe'																											=> { :a => "Lem" },
	'What is Lem\'s last name'																															=> { :a => "Skinker" },
	'(Lem\'s Clothes hang on him like a|Lem\'s clothing hangs on him like a)'																			=> { :a => "Scarecrow" },
	'Turask\'s last name is'																															=> { :a => "Maldib" },
	'What colou?r are Turask\'s boots'																													=> { :a => "Orange" },
	'What colou?r vest does Turask have on'																												=> { :a => "Green" },
	'What does Turask have on his head'																													=> { :a => "Turban" },
	'What is the name of the locksmith'																													=> { :a => "Jyhm" },
	'What colou?r is Jyhm\'s hair'																														=> { :a => "Black" },
	'What is the white swan sitting on'																													=> { :a => "Ora" },
	'What is the name of the locksmith\'s apprentice'																									=> { :a => "Nerm" },
	'What does Nerm have on his chin'																													=> { :a => "Goatee" },
	'From whom can a pair of saffron slippers be purchased'																								=> { :a => "Tynira" },
	'What does Tynira sell'																																=> { :a => "Slippers" },
	'Precise stitches is Tynira\'s'																														=> { :a => "Trademark" },
	'What is mounted on the walls of Girvahk\'s'																										=> { :a => "Weapons" },
	'What can you find opposite the bar in Girvahk\'s'																									=> { :a => "Fireplace" },
	'Girvahk\'s shop widely known for his'																												=> { :a => "Bar" },
	'What type of weapon is displayed in the case in Girvahk\'s'																						=> { :a => "Mace" },
	'From whose shop can basal moss be purchased'																										=> { :a => "Kelph" },
	'What colou?r is Kelph\'s hair'																														=> { :a => "Brown" },
	'What is Kelph displaying'																															=> { :a => "Bluebird" },
	'Where can you buy a narrow gold ring'																												=> { :a => "Darbo" },
	'What is Darbo\'s cottage made of'																													=> { :a => "Stone" },
	'What does the merchant Beltheine sell'																												=> { :a => "Flowers" },
	'What does Walsor jingle'																															=> { :a => "Silver pieces" },
	'What does Walsor have portruding'																													=> { :a => "Stomach" },
	'How many spheres can you find above the door at Walsors'																							=> { :a => "Three" },
	'Walsor\'s store is a'																																=> { :a => "Corner" },
	'What colou?r are Walsor\'s suspenders'																												=> { :a => "Grey" },
	'What is the woodcrafter\'s last name'																												=> { :a => "Crafyien" },
	'What sort of skin does Will Oakum have'																											=> { :a => "Leathery" },
	'What is outside of Sagrassa\'s cottage'																											=> { :a => "Plaque" },
	'What covers Tyalosa'																																=> { :a => "Dust" },
	'Tyalosa\'s last name is'																															=> { :a => "Rhus" },
	'(Who is the owner of Ouslanders Garb|Ouslanders garb is owned by)'																					=> { :a => "Red McKrieg" },
	'Red is a member of the'																															=> { :a => "Giantman" },
	'What colou?r is Gertie\'s apron'																													=> { :a => "Saffron" },
	'What colou?r is Vlodimm\'s voice'																													=> { :a => "Ivory" },
	'What is the old woman\'s name'																														=> { :a => "Mabel" },
	'What is wrong with the cat'																														=> { :a => "Peglegged" },
	'What kind of captain wanders the town'																												=> { :a => "Guild" },
	'To what race does the lone fisherman belong'																										=> { :a => "Elven" },
	'What surrounds the school'																															=> { :a => "Yard" },
	'What surrounds the local school'																													=> { :a => "Fence" },
	'What colou?r is the library'																														=> { :a => "White" },
	'What is the famed Banaltra\'s cage made out of'																									=> { :a => "Vultite" },
	'What is the cage made of which holds the famed Banaltra'																							=> { :a => "Vultite" },
	'What do the fisherman pull as depicted by the panel'																								=> { :a => "Nets" },
	'What do the parents tend as depicted by the panels'																								=> { :a => "Children" },
	'What do the farmers till as depicted by the panels'																								=> { :a => "Soil" },
	'(What does the woodsman cut as depicted by the panels|Depicted in the panels\, what did the woodsman chop)'										=> { :a => "Lumber" },
	'(What is the poor side of town called|The poor section of town is called)'																			=> { :a => "MarshTown" },
	'(What colou?r is the North Wall|What colou?r is the sphere)'																							=> { :a => "Blue" },
	'What can you find at the mouth of the pit'																											=> { :a => "Bones" },
	'What colou?r is the gate to Vornavis'																												=> { :a => "Ebony" },
	'What colou?r is the gate outside of Kai\'s temple|What colou?r is the gate outside of Kai\'s temple'													=> { :a => "Crimson" },
	'What colou?r is Ronan\'s gate'																														=> { :a => "black" },
	'What type of pond can you find in Ronan\'s courtyard'																								=> { :a => "Koi" },
	'What temple do the kissing swans lead to'																											=> { :a => "Oleani's" },
	'Which temple do the kissing swans lead to'																											=> { :a => "Oleani's" },
	'What is behind the altar in Charl\'s Quay'																											=> { :a => "Trident" },
	'Lorminstra\'s temple'																																=> { :a => "White" },
	'What is the curtain made of in the Ancient Shrine'																									=> { :a => "Burlap" },
	'From what metal is the anvil at the museum made of'																								=> { :a => "Mithril" },
	'What is on the ceiling of the basement in the museum'																								=> { :a => "Moss" },
	'What structure stands near the lake'																												=> { :a => "House" },
	'In what state of condition is the house by the lake'																								=> { :a => "Disrepair" },
	'What do the ants encase near the lake'																												=> { :a => "Basket" },
	'Who used to live in the house by the lake'																											=> { :a => "Sailor" },
	'What kind of bushes can you find on the west road'																									=> { :a => "Holly" },
	'What can be seen littering a field on the west road'																								=> { :a => "Boulders" },
	'What can you find littering the field on the West Road'																							=> { :a => "Boulders" },
	'What colou?r are the windows and awnings on Triton road'																							=> { :a => "Rose" },
	'Along the forest road is a boulder\.  What shape does it resemble'																					=> { :a => "Fist" },
	'What can you find lying off the path to the north on the forest road'																				=> { :a => "Wheel" },
	'To what type of road does the tower lead'																											=> { :a => "Cobblestone" },
	'What can be seen surrounding a tower'																												=> { :a => "Scaffolds" },
	'What could the Broken tower once have been'																										=> { :a => "Watchtower" },
	'What can be found dripping to the floor in the Caverns'																							=> { :a => "Wax" },
	'The water in the Caverns contains what'																											=> { :a => "Salt" },
	'What color is the thatch on the cottage near the orchard'																							=> { :a => "Golden" },
	'What fruit grows in the orchard'																													=> { :a => "Apples" },
	'What type of trees grow in the orchard'																											=> { :a => "Apple" },
	'(What lies by the empty carts in the orchard|What can be found lying around empty carts in the orchard)'											=> { :a => "Baskets" },
	'What creature is commonly seen in the orchard'																										=> { :a => "Daggerbeak" },
	'What spans the canal beneath the trees'																											=> { :a => "Planks" },
	'Along the coast\, near the foggy valley what colou?r tint'																							=> { :a => "Grey" },
	'Along the coast\, near the foggy valley\, what sort of colou?r tint'																				=> { :a => "Grey" },
	'(What tree can be found budding|What type of tree is budding)'																						=> { :a => "Linden" },
	'What can you find standing near the surf on the South Beach'																						=> { :a => "Seagulls" },
	'What is the bell doing on the South Beach'																											=> { :a => "Ringing" },
	'can be found on Jag Point'																															=> { :a => "Stones" },
	'The night comes softly with her velvety cloak'																										=> { :a => "Embrace" },
	'The basin in the shrine located in the Marble Springs neighborhood of'																				=> { :a => "Water" },
	'What sort of leaf is portrayed on the mat at the shrine'																							=> { :a => "Oak" },
	'The shard in the center of marble springs neighborhood of Ta\'vaalor'																				=> { :a => "West" },
	'What material is the massive shard in the center of the marble springs'																			=> { :a => "Quartz" },
	'What does the elven statue in Marble Springs hold is its right hand'																				=> { :a => "Longsword" },
	'What river plant are the wind chimes in the Marble Springs neighborhood of'																		=> { :a => "Reed" },
	'What is the marble statue of an elven woman in the Marble Springs neighborhood'																	=> { :a => "Greatsword" },
	'lies buried here'																																	=> { :a => "Dream" },
	'curtain down and pins it with a star'																												=> { :a => "Twilight" },
	'when soft voices die, vibrates in the memory'																										=> { :a => "Music" },
	'Complete this phrase as'																															=> { :a => "Past" },
	'in every gesture dignity and beauty in her smile'																									=> { :a => "Heavens" },
	'till it landed in his hair'																														=> { :a => "Ranger" },
	'In what year was ranger Elrohan buried'																											=> { :a => "4881" },
	'What type of rose adorns the plaque in memory of Tinuldor Nondel in the cemetery'																	=> { :a => "Wild" },
	'What has been built in the cemetery in honor of Tinuldor Nondel'																					=> { :a => "Cenotaph" },
	'Where in the cemetery can a sarcophagus be found'																									=> { :a => "Mausoleum" },
	'What material is the sign at the entrance to the Glaise Cnoc cemetery made of'																		=> { :a => "Bronze" },
	'In what year was the Glaise Cnoc cemetery established'																								=> { :a => "4879" },
	'What sort of tree grows just past the gates of the cemetery'																						=> { :a => "Willow" },
	'What is the obelisk in the graveyard made from'																									=> { :a => "Granite" },
	'What twin creatures adorn a statue of a spear that stands in the cemetery'																			=> { :a => "Asp" },
	'What represents the noble houses in the cemetery\'s crypt'																							=> { :a => "Tapestries" },
	'What type of trees grow to the north of the cemetery'																								=> { :a => "Tanik" },
	'In what year was Nadia Tinilia buried'																												=> { :a => "4924" },
	'The statue with ruby eyes in the Plains of Bone is of what'																						=> { :a => "Drake" },
	'What means of travel has been nearly swallowed by the thorny brambles growing'																		=> { :a => "Rowboat" },
	'What is centered in the bone gate that connects the Plains of Bones and the Boneyard'																=> { :a => "Skull" },
	'What pink and purple blooming weeds thrive at the edge of the abandoned vineyard'																	=> { :a => "Thistle" },
	'The skeleton of what sort of animal can be found in the abandoned vineyard'																		=> { :a => "Bear" },
	'What odd material coats the inside of a fruit-harvesting bucket that has'																			=> { :a => "Soot" },
	'The spotted leapers that populate the meadows appear to be a cross of a wolf and what'																=> { :a => "Frog" },
	'What hammered metal is left abandoned in the neartofar forest'																						=> { :a => "Copper" },
	'What sort of skeleton can be found impaled on a sharpened pine in the Neartofar Forest'															=> { :a => "Humanoid" },
	'What material is the monolith that towers above the Neartofar Forest composed of'																	=> { :a => "Granite" },
	'What force inhabits the barracks and stockade in the Neartofar Forest'																				=> { :a => "Ogre" },
	'What is the first name of the founder of Ta\'Vaalor'																								=> { :a => "Aradhul" },
	'Where does the sign say that the proprietor of the tavern on Shimeraern Var has gone'																=> { :a => "Fishing" },
	'Which creatures form part of the decorative carvings on the exterior of the chocolate'																=> { :a => "Faeries" },
	'A replica of an antique forge is located in armory. What material is this forge made of'															=> { :a => "Crystal" },
	'On what wey or var, in Ta\'Vaalor\, is the statue and fountain honoring Phoen located'																=> { :a => "Amaranth" },
	'On what wey or var is Ta\'Vaalor\'s healer located'																								=> { :a => "Aethenireas" },
	'What color are the eyes of the healer in Ta\'Vaalor'																								=> { :a => "Lavender" },
	'Whos owns the sundries shop in Ta\'Vaalor'																											=> { :a => "Phisk" },
	'What creature does the large statue inside the Ta\'Vaalor clerical supply shop depict'																=> { :a => "Drake" },
	'What type of feathers are the pillows in the barracks made of'																						=> { :a => "Cockatrice" },
	'Who owns the furs and pelts shop in Ta\'Vaalor'																									=> { :a => "Ghaerdish" },
	'What is the name of the owner of the jewelry store that is located in the southeast'																=> { :a => "Tmareantha" },
	'Who runs Ta\'Vaalor\'s delivery service'																											=> { :a => "Sassion" },
	'What type or rare white silk curtains adorn the windows of the gem shop'																			=> { :a => "Dupioni" },
	'Who owns Ta\'Vaalor\'s bakery'																														=> { :a => "Sweethen" },
	'A granite bench that serves a dual purpose as a grave marker sits between a pair of what'															=> { :a => "Junipers" },
	'What silvery-blue wood is the altar in the Hall of the Arkati in Ta\'Vaalor fashioned of'															=> { :a => "Haon" },
	'What sort of animal skull can be found in the barley field'																						=> { :a => "Feline" },
	'What tall, white vines climb thewalls surrounding Ta\'vaalor\'s gardens of ancients'																=> { :a => "Jasmine" },
	'A mound of what sort of chaff exists to the northeast of Yander\'s barn'																			=> { :a => "Wheat" },
	'What is the dais in the catacombs covered with'																									=> { :a => "Blood" },
	'Some boxes have been stashed in a back passage between the catacombs and the wilds'																=> { :a => "Trezzures" },
	'What material composes the remains of the boundary marker at the edge of Fethayl Bog'																=> { :a => "Iron" },
	'Who funds the free passage across the lake to the north of Ta\'Vaalor'																				=> { :a => "Tyrnian" },
	'(The coral berry shrubs at the edge of the briar patch have what color flowers|What color ribbon does Kelph use to tie her hair)'					=> { :a => "Yellow" },
	'What sort of briar is the briar thicket composed of'																								=> { :a => "Hawthorn" },
	'What is the name of the river that lies to the south of Ta\'Vaalor'																				=> { :a => "Mistydeep" },
	'What spicy\-scented bush grows along the trail through Fearling Pass'																				=> { :a => "Sarsaparilla" },
	'(What image adorns the gates standing to the east of the lower fields|What has Kelph captured and displays for all to see)'						=> { :a => "Songbird" },
	'What is the marble statue in the center of the building in the wildflower field depicted as'														=> { :a => "Jug" },
	'What nasty-looking bushes grow on the side of the stone wall that runs along the'																	=> { :a => "Thorn" },
	'What sort of vines grow to the west of the wall that borders the wildflower fields'																=> { :a => "Grape" },
	'What sort of skeleton can be found\, half overgrown in the upper fields'																			=> { :a => "Elven" },
	'A rare strain of plant thrives in The Legendary Rest'																								=> { :a => "Philodendron" },
	'What creature\'s skull adorns the wall in The Legendary Rest\'s Desert Evening Room'																=> { :a => "Minotaur" },
	'What sort of brass bird adorns the wall in The Legendary Rest\'s Lofty Peaks Room'																	=> { :a => "Eagle" },
	'What type of golden tree grows in the center of the Wyvern Keep Lobby'																				=> { :a => "Pine" },
	'What metal is named after the Vaalor elves that discovered it'																						=> { :a => "Vaalorn" },
	'What can you find littering the dunes in the pine forest'																							=> { :a => "Cones" },
	'(What color fabric are the chairs in the entryway of Wyvern Keep unholstered in|What metal veins the shard in the center of the Marble Springs neighborhood)' => { :a => "Gold" },
	'(What color berries grow on the brambles that are growing into the abandoned vineyard|The official colors of Ta\'Vaalor\, as seen on the town\'s pennants\, are gold and what|What color roses climb the outside of Ta\'Vaalor\'s sundries shop|What color are the stripes on the grey skin of a striped relnak)'			=> { :a => "Red" },
	
}

critter_info = {
	
	'troll skin'			=> { :critter_name => "cave trolls", 				:level => 16, 
	:room_numbers => "5147, 5146, 5144, 5131, 5129, 5130, 5132, 5133, 5134, 5135, 5143, 5136, 5137, 5142, 5141, 5140, 5139, 5138" },
	
	'spider leg'			=> { :critter_name => "greater spiders", 			:level => 8, 
	:room_numbers => "5129, 5147" },
	
	'daggerbeak wing'		=> { :critter_name => "black-winged daggerbeaks", 	:level => 1,
	:room_numbers => "5444, 5447, 5448, 5450, 5445, 5443, 5453, 5452, 5455, 5451, 5458, 5459, 5456, 5454, 5464, 5462, 5461, 5463, 5460, 5446, 5449, 5442" },
	
	'ghoul scraping'		=> { :critter_name => "greater ghouls", 			:level => 3, 
	:room_numbers => "7263, 7253, 7252, 7272, 7262, 7251, 7254, 7255, 7256, 7257, 7258, 7259, 7265, 7268, 7267, 7266, 7270, 7264, 7271" },
	
	'troll hide'			=> { :critter_name => "forest trolls", 				:level => 14,
	:room_numbers => "1272, 12998, 12999, 13000, 13001, 13002, 13003, 13004, 12996, 1271, 153, 12993, 5266, 5265, 5213" },
	
	'cobra skin'			=> { :critter_name => "cobras", 					:level => 4,
	:room_numbers => "7286, 7285, 7284, 7283, 7278, 7279, 7280, 7281, 7282, 7287" },
	
	'salamander skin'		=> { :critter_name => "fire salamanders", 			:level => 3,
	:room_numbers => "5169, 5170, 5171, 5172, 5173, 5174, 5175, 5176, 5177, 5179, 5181, 5182, 5183, 5184, 5185, 5188, 5187, 5186, 5167" },
	
	'urgh hide'				=> { :critter_name => "urghs", 						:level => 4, 
	:room_numbers => "5056, 5057, 5058, 5059, 5060, 5061, 5062, 5063, 5064, 5065, 5066, 5067, 5070, 5071, 5072, 5073, 5074, 5075, 5076, 5077, 5078, 5080, 5081, 5082, 5083, 5055" },
	
	'shelfae scale'			=> { :critter_name => "shelfae soldiers", 			:level => 7,
	:room_numbers => "5380, 5613, 5614, 5615, 5616, 5617, 5618, 5619, 5620, 5621, 5622, 5623, 5624, 5625, 5626, 5634, 5633, 5632, 5631, 5630, 5629, 5628, 5627" },
	
	'mangy kobold scalp'	=> { :critter_name => "mongrel kobolds", 			:level => 4, 
	:room_numbers => "5056, 5057, 5058, 5059, 5060, 5061, 5062, 5063, 5064, 5065, 5066, 5067, 5070, 5071, 5072, 5073, 5074, 5075, 5076, 5077, 5078, 5080, 5081, 5082, 5083, 5055" },
	
	'panther pelt'			=> { :critter_name => "panthers", 					:level => 15, 
	:room_numbers => "5380, 5613, 5614, 5615, 5616, 5617, 5618, 5619, 5620, 5621, 5622, 5623, 5624, 5625, 5626, 5634, 5633, 5632, 5631, 5630, 5629, 5628, 5627" },
	
	'orc scalp'				=> { :critter_name => "greater orcs", 				:level => 8, 
	:room_numbers => "1272, 12998, 12999, 13000, 13001, 13002, 13003, 13004, 12996, 1271, 153, 12993, 5266, 5265, 5213" },
	
	'crocodile snout'		=> { :critter_name => "crocodiles", 				:level => 9, 
	:room_numbers => "5380, 5613, 5614, 5615, 5616, 5617, 5618, 5619, 5620, 5621, 5622, 5623, 5624, 5625, 5626, 5634, 5633, 5632, 5631, 5630, 5629, 5628, 5627" },
	
	'ogre tusk'				=> { :critter_name => "forest ogres", 				:level => 17, 
	:room_numbers => "5247, 5248, 5249, 5250, 5252, 5254, 5255, 5257, 5674, 5253, 5256, 5258, 5259, 5260, 5261, 5262, 5676, 5264, 5263" },
	
	'thrak hide'			=> { :critter_name => "thraks", 					:level => 8, 
	:room_numbers => "5149, 5150, 5151, 5152, 5153, 5155, 5154, 5156, 5157, 5158, 5159, 5160, 5162, 5163, 5164, 5165, 5166, 5161, 5148" },
	
	'whiptail stinger'		=> { :critter_name => "whiptails", 					:level => 4, 
	:room_numbers => "5211, 5212, 5214, 5215, 5216, 5217, 5218, 5219, 5220, 5221, 5222, 5223, 5224, 5226, 5227, 5228, 5229, 5230, 5231" },
	
	'shelfae crest'			=> { :critter_name => "shelfae chieftains", 		:level => 11, 
	:room_numbers => "5069, 5380, 5613, 5614, 5615, 5616, 5617, 5618, 5619, 5620, 5621, 5622, 5623, 5624, 5625, 5626, 5627, 5628, 5629, 5630, 5631, 5632, 5633, 5634" },
	
	'puma hide'				=> { :critter_name => "puma", 						:level => 15, 
	:room_numbers => "5148, 5149, 5150, 5151, 5152, 5153, 5154, 5155, 5156, 5157, 5158, 5159, 5160, 5161, 5162, 5163, 5164, 5165, 5166" },
	
	'orc ear'				=> { :critter_name => "dark orcs", 					:level => 12, 
	:room_numbers => "6909, 6914, 6911, 6910, 6926, 6913, 6912, 6915, 6925, 6924, 6916, 17095, 6917, 6918, 6920, 6919, 6921, 6922" },
	
	'boar tusk'				=> { :critter_name => "great boar", 				:level => 10, 
	:room_numbers => "4267, 4268, 4269, 4289, 4290, 4290, 4291, 4292, 4293, 4294, 4295, 4296, 4297, 4272, 4271, 4270, 4273, 4274, 4298" },
	
	'manticore tail'		=> { :critter_name => "manticore", 					:level => 9, 
	:room_numbers => "4209, 4210, 4211, 4275, 4213, 4212, 4276, 4299, 4300, 4265, 4266, 4301, 4339, 4340, 4341, 4342, 4343" },
	
	'pale crab pincer'		=> { :critter_name => "pale crab", 					:level => 2, 
	:room_numbers => "5215, 5216, 5217, 5218, 5219, 5220, 5221, 5222, 5223, 5224, 5226, 5227, 5228, 5229, 5230, 5231, 5228, 5229" },
	
	'coyote tail'			=> { :critter_name => "coyote", 					:level => 5, 
	:room_numbers => "5055, 5056, 5057, 5058, 5059, 5060, 5061, 5062, 5063, 5064, 5065, 5066, 5067, 5068, 5070, 5071, 5072, 5073, 5074, 5075, 5076, 5077, 5078, 5080, 5081, 5082, 5083, 13004, 12996, 1271, 153, 12993, 5213, 5265, 5266" },
	
	'troll scalp'			=> { :critter_name => "thunder troll", 				:level => 18, 
	:room_numbers => "5269, 5270, 5271, 5272, 5273, 5274, 5275, 5276, 5277, 5278, 5279, 5280, 5281, 5282, 5283, 5284, 5285, 5286" },
	
}

item_info = {
	'reinforced shield'		=> { :item_cost => 50, 		:item_order_number => 22, 	:item_shop_room_number => 12813 },
	'arm greave'			=> { :item_cost => 40, 		:item_order_number => 19, 	:item_shop_room_number => 12813 },
	'chain hauberk'			=> { :item_cost => 1190, 	:item_order_number => 14, 	:item_shop_room_number => 12813 },
	'leather breastplate'	=> { :item_cost => 380,		:item_order_number => 7, 	:item_shop_room_number => 12813 },
	'metal aventail'		=> { :item_cost => 30, 		:item_order_number => 25, 	:item_shop_room_number => 12813 },
	'reinforced shield'		=> { :item_cost => 90, 		:item_order_number => 22, 	:item_shop_room_number => 12813 },
	'small chest'			=> { :item_cost => 100, 	:item_order_number => 8, 	:item_shop_room_number => 8664 },
	'heavy backpack'		=> { :item_cost => 90,	 	:item_order_number => 9, 	:item_shop_room_number => 8664},
	'gold lockpick'			=> { :item_cost => 2310, 	:item_order_number => 13, 	:item_shop_room_number => 5612 },
	'crystal amulet'		=> { :item_cost => 1560, 	:item_order_number => 2, 	:item_shop_room_number => 9278 },
	'silver wand'			=> { :item_cost => 1580, 	:item_order_number => 7, 	:item_shop_room_number => 9278 },
	'war hammer'			=> { :item_cost => 190, 	:item_order_number => 30, 	:item_shop_room_number => 12815 },
}

sol_rooms = [ 1432, 1427, 1426, 1425, 1431, 150, 1434, 1435, 1440, 13516, 1441, 9008, 9009, 9015, 9020, 9022, 9021, 9013, 9014, 9012, 9011, 9010, 1442, 1436, 594, 1444, 1445, 1446, 149, 1447, 1449, 1437, 1607, 1608, 3907, 3906, 3905, 1448, 1443, 13489, 1456, 1457, 1455, 1454, 1453, 1474, 1604, 1605, 1606, 1438, 1458, 1463, 1462, 1459, 1461, 1472, 1473, 1476, 1477, 1483, 5949, 1484, 1478, 1479, 1471, 1465, 1467, 1464, 1468, 1469, 1507, 1506, 1505, 1470, 1599, 1601, 1602, 1481, 1482, 1485, 1487, 1488, 1486, 1489, 1490, 1492, 1539, 1598, 1594, 1595, 1596, 1597, 1501, 1502, 1503, 1504, 1600, 1603, 1508, 1509, 1510, 1511, 1512, 1513, 1514, 1538, 1494, 1495, 1496, 1536, 1542, 1541, 1547, 1548, 1540, 1546, 1550, 1549, 1577, 1580, 1578, 1579, 1551, 1552, 1553, 1554, 1556, 1557, 1559, 1560, 1561, 1565, 1566, 1567, 1532, 1524, 1520, 1500, 1515, 1518, 1517, 1519, 1522, 1523, 1527, 1526, 1528, 1530, 1529, 1525, 1531, 1533, 1568, 1569, 1534, 14234, 1562, 1563, 1564, 1576, 1572, 1574, 1573, 1571, 1575, 1582, 1581, 1585, 1586, 1587 ]

go_to_room = proc{
	if Room.current.id != target_room
		move 'out' if checkpaths 'out'
		kill_script "go2" if running? "go2"
		wait_until { !running? "go2" }
		start_script 'go2', [ target_room ]
		wait_while{ running?('go2') }
	end
}

display_message = proc{
	_respond "##############################"
	_respond "##############################"
	_respond "##############################"
	_respond "##############################"
	_respond "##############################"
	_respond "#{message_to_say}"
	_respond "##############################"
	_respond "##############################"
	_respond "##############################"
	_respond "##############################"
	_respond "##############################"
}

turn_in_items = proc{
	fput "stow all" if checkleft || checkright
	number_of_items.times{
		break if current_task == "Finished."
		item_name = "white robe" if item_name =~ /flowing white/
		item_name = "chest" if item_name =~ /small chest/
		item_name = item_name.chop if item_name[-1] == "s"
		fput "stow left" if checkleft
		fput "stow right" if checkright
		if item_name == "chest"
			3.times{
				waitrt?
				unless checkright || checkleft
					fput "get my chest"
					sleep 0.2
				end
			}
		else
			3.times{
				waitrt?
				unless checkright || checkleft
					fput "get my #{item_name.scan(/\w+/).values_at(0).join(",")} #{item_name.scan(/\w+/).values_at(-1).join(",")}"
					sleep 0.2
				end
			}
		end
		if checkright.nil? && checkleft.nil?
			break
		else
			if current_task == "skins"
				fput "offer my #{item_name.scan(/\w+/).values_at(0).join(",")} #{item_name.scan(/\w+/).values_at(-1).join(",")}"
			else
				fput "put my #{item_name} on altar"
				fput "offer #{item_name} on altar"
			end
			while line = get
				if line =~ /\"only (\d+) more to go to complete your/
					number_of_items = $1.to_i
					break
				elsif line =~ /You have completed your (gift|service)/
					current_task = "Finished."
					break
				end
			end
		end				
	}
}

visit_poobah = proc{
	target_room = 4595
	go_to_room.call
	target_room = 4593
	go_to_room.call
	while line = get
		if line =~ /The powers you have been granted are but a merest fraction of what is available to the truly worthy\!|Therefore\, if at any time you feel that you cannot continue|you are not the first to travel down this dangerous road/
			break
		elsif line =~ /Your blood runs cold as the Poohbah laughs at you\!/
			message_to_say = "Congratulations! You are now a master in COL!"
			display_message.call
			exit
		end
	end
}

check_task = proc{
	fput "society task"
	while line = get
		if line =~ /Report to the High Taskmaster for your initial instructions\.|You have completed your task from the Grand Inquisitor\.  Report to the High Taskmaster for your next promotion\./
			target_room = 4594
			go_to_room.call
			target_room = 4595
			go_to_room.call
			while line = get
				if line =~ /This secret sign will allow you to discreetly identify yourself to other members of the lodge\./
					target_room = 4596
					go_to_room.call
					waitfor "As this is your first service, we shall make it a simple one"
					break
				elsif line =~ /Congratulations\, #{Char.name}\!  By the power invested in me by the Grand Poohbah/
					current_task = "Poobah" if line =~ /I declare you to be a Master of rank 20\!/
					break
				elsif line =~ /The High Taskmaster looks at you\, consults her notes\, and then announces in a loud voice\: \"The Poohbah would like to have a word with you/
					current_task = "Poobah"
					break
				elsif line =~ /I know you have completed the requirements for advancement in rank/
					move 'south'
					message_to_say = "You must wait before you can advance in your rank. I will wait here until enough time has passed then I will continue on mastering. If you prefer you can kill this script and run it again after enough time has passed or you can leave the script running in the background and it will continue mastering after enough time has passed."
					display_message.call
					wait_until { !Spell[9011].active?}
					check_task.call
				end
			end
			visit_poobah.call if current_task == "Poobah"
			current_task = nil
			check_task.call
		elsif line =~ /Report to the Master of Services for your next task\./
			target_room = 4595
			go_to_room.call
			target_room = 4596
			go_to_room.call
			waitfor "it seems you need to be assigned a service"
			check_task.call
		elsif line =~ /You have been tasked to present the Master of Services with (\d+) more (.*)\./
			current_task = "skins"
			number_of_items = $1.to_i
			item_name = $2
			message_to_say = "Checking to see if you have the necessary skins."
			display_message.call
			target_room = 4596
			go_to_room.call
			turn_in_items.call
			if current_task == "Finished."
				check_task.call
			else
				item_name = item_name.chop if item_name[-1] == "s"
				if critter_info.include?(item_name)
					message_to_say = "You need to obtain #{number_of_items} #{item_name}, which can be skinned from #{critter_info[item_name][:critter_name]} (level #{critter_info[item_name][:level]}) and found in these lich room numbers: #{critter_info[item_name][:room_numbers]}. Once you have obtained the necessary skins run this script again and I will turn them in and continue on."
				else
					message_to_say = "You need to obtain #{number_of_items} #{item_name}. Unfortunately the critter info for this skin is not in this script's database. If you wish to help complete this script find the necessary info (critter name, critter level, lich room numbers where critter can be found) and give the information to Tgo01/Dreaven. Once you have obtained the necessary skins run this script again and I will turn them in and continue on."
				end
				display_message.call
				exit
			end
		elsif line =~ /You have completed your task from the Master of Services\.  Report to the Master of Gifts for your next task\./
			target_room = 4595
			go_to_room.call
			target_room = 4598
			go_to_room.call
			while line = get
				break if line =~ /\"As this is your first gift\, we shall make it an easy one\,\"|it seems you need to be assigned a gift/
			end
			check_task.call
		elsif line =~ /You have completed your task from the Master of Gifts\.  Report to the Grand Inquisitor for your next task\.|You have been tasked to answer the following question to the Grand Inquisitor\'s satisfaction/
			target_room = 4595
			go_to_room.call
			target_room = 4597
			go_to_room.call
			got_the_answer = nil
			while line = get
				answers.each{ |key,value|
					if line =~ /#{key}/i
						fput "answer #{answers[key][:a]}"
						got_the_answer = true
						break
					end
				}
				break if got_the_answer
			end
			check_task.call
		elsif line =~ /You have been tasked to present the Master of Gifts with (\d+) more offerings of (an?|some) (.*)\./
			current_task = "gifts"
			item_cost = nil
			number_of_items = $1.to_i
			item_name = $3
			item_name = item_name.chop if item_name[-1] == "s"
			if item_info.include?(item_name)
				item_cost = item_info[item_name][:item_cost]
				item_order_number = item_info[item_name][:item_order_number]
				item_shop_room_number = item_info[item_name][:item_shop_room_number]
				total_item_cost = ((number_of_items * item_cost) * 1.5).floor
			end
			message_to_say = "Checking to see if you have the necessary items."
			display_message.call
			target_room = 4598
			go_to_room.call
			turn_in_items.call
			if current_task == "Finished."
				check_task.call
			elsif item_name =~ /white rob/
				message_to_say = "You need to obtain #{number_of_items} flowing white robes, which can be looted from sea nymphs (level 2) and found in these lich room numbers: 5127, 5125, 5126, 5205, 5204, 5206, 5208, 5210, 5211. Once you have obtained the necessary items run this script again and I will turn them in and continue on."
				display_message.call
				exit
			elsif item_cost == nil
				message_to_say = "You need #{number_of_items} #{item_name}. Unfortunately this item isn't in this script's database. Once you have obtained the necessary number of the required items run this script again and I will turn in the items and continue on."
				display_message.call
				exit
			else
				message_to_say = "Buying necessary items."
				display_message.call
				move 'out' if checkpaths 'out'
				kill_script "go2" if running? "go2"
				wait_until { !running? "go2" }
				start_script 'go2', [ 'bank', '--disable-confirm' ]
				wait_while{ running?('go2') }
				fput "depo all"
				result = dothistimeout "withdraw #{total_item_cost} silvers", 3, /and then hands you .* silvers?\.|you don\'t seem to have that much in the account\./
				if result =~ /and then hands you .* silvers?\./
					nil
				elsif result =~ /you don\'t seem to have that much in the account/
					message_to_say = "You don't have enough silvers to finish this task. You need at least #{total_item_cost} silvers to finish. This script uses the Solhaven bank exclusively so keep your bank account there stocked with silvers to finish mastering COL."
					display_message.call
					exit
				end
				target_room = item_shop_room_number
				go_to_room.call
				fput "stow all" if checkleft || checkright
				number_of_items.times{
					fput "order #{item_order_number}"
					fput "buy"
					fput "stow right"
				}
				target_room = 4598
				go_to_room.call
				turn_in_items.call
				check_task.call
			end
		end
	end
}

if Char.level < 3
		message_to_say = "You must be at least level 3 to join a society."
		display_message.call
		exit
end
fput "society"
while line = get
	if line =~ /(Guardians of Sunfist|Order of Voln)/i
		sleep 1
		message_to_say = "You are currently a member of #$1. You need to leave your current society if you wish for this script to join and master COL for you."
		display_message.call
		exit
	elsif line =~ /You are a member in the Council of Light at rank 20\./
		current_task = "Poobah"
		break
	elsif line =~ /You are a Master in the Council of Light\./
		sleep 1
		message_to_say = "You are already a master in COL, this script can do nothing for you."
		display_message.call
		exit
	elsif line =~ /Council of Light/
		current_task = "Check task."
		break
	elsif line =~ /You are not a member of any society at this time\./
		sleep 1
		current_task = "Join COL."
		break
	end
end
if current_task == "Check task."
	check_task.call
elsif current_task == "Poobah"
	visit_poobah.call
elsif current_task == "Join COL."
	message_to_say = "You are not currently a member of COL. If you wish for this script to join COL in Solhaven then proceed to master it then simply NOD. Otherwise exit this script by typing ;kill colmaster"
	display_message.call
	waitfor "You nod."
	message_to_say = "Do you currently have the invitation from the haggard matron?\nIf yes then enter NOD and we'll go to the Poobah to join COL.\nIf no then enter SHAKE and I will find the haggard matron and get the invitation then I'll go to the Poobah to join COL."
	display_message.call
	while line = get
		if line =~ /You nod\./
			current_task = "Find Poobah"
			break
		elsif line =~ /Shake what\?/
			current_task = "Find matron"
			break
		end
	end
	if current_task == "Find matron"
		temp_rooms = sol_rooms
		until GameObj.npcs.find {|i| i.name =~ /matron/ }
			temp_rooms = sol_rooms if temp_rooms == nil || temp_rooms.length == 0
			target_room = Room.current.find_nearest(temp_rooms)
			move 'out' if checkpaths 'out'
			kill_script "go2" if running? "go2"
			wait_until { !running? "go2" }
			start_script 'go2', [ target_room.to_s ]
			wait_while{ running?('go2') }
			temp_rooms.delete(target_room)
		end
		while line = get
			if line =~ /(^YOU RESOLVE TO REVEAL WHAT YOU HAVE LEARNED TO NO ONE ELSE\!|^\"You are one of the special ones\,\" whispers the haggard matron\.|^\"Take a good close look at the goblin\,\" whispers the haggard matron)/
				message_to_say = "Got the invitation. Going to the Poobah to join COL."
				display_message.call
				break
			elsif line =~ /A haggard matron totters (.*)\, staring down at her feet as she shuffles along\./
				move "#{$1}"
			end
		end
	end
	target_room = 4593
	go_to_room.call
	while line = get
		if line =~ /\"I will never betray the council\"/
			fput "say I will never betray the council"
			break
		end
	end
	check_task.call
end