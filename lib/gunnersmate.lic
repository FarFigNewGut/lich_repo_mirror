=begin
This script will prime and ready your cannons, then if desired fire them at the enemy vessel.
It is important to know that it is not programmed to stop when the enemy throws thier grappels, so be vigilant and ready to kill the script when its time.
This script is not intended to be used AFK in anyway.
Enjoy

~Peggyanne
PS: feel free to send me any bugs via discord Bait#4376 and I'll try my best to fix them.
2/16/2021 Initial Release, Should support all ship types.
2/19/2021 Now clears your hands and exits when you are boarded (Sorry I didn't do this sooner guys!)
9/11/2021 Will TRY to clear your hands when you run the script, if unable it will exit out and tell you to clear your hands.)
=end

stand_up = proc{
if !checkstanding
	fput "stand"
	stand_up.call
else
end
}

ship_boarded = proc{
waitrt?
fput "drop left"
fput "drop right"
echo "We've been boarded sir! To Arms!"
exit
}

move = proc{
result = dothistimeout "#{@move}", 1, /Thirty second warning|The sides of the|...wait/
    if result =~ /Thirty second warning|The sides of the/
		ship_boarded.call
	elsif result =~ /...wait/
		pause 1
		move.call
	else
    end
}

load_cannon = proc{
waitrt?
result = dothistimeout "load cannon", 5, /Thirty second warning|The sides of the|You cannot fire your|You carefully lift your|You need to be holding|The (.*) cannon already|...wait/
	if result =~ /The sides of the|You cannot fire your|Thirty second warning/
	ship_boarded.call
	elsif result =~ /You carefully lift your|...wait/
	load_cannon.call
	elsif result =~ /You need to be holding/
	check_balls.call
	elsif result =~ /The (.*) cannon already/
		waitrt?
		if @fire == FALSE
			then
			if checkleft
			then
			@done = TRUE
			(eval @deck).call
			fput "put ball in balls"
			fput "put ball in balls"
			echo "The cannons are primed and ready sir!"
			exit
			elsif checkright
			then
			@done = TRUE
			(eval @deck).call
			fput "put ball in balls"
			echo "The cannons are primed and ready sir!"
			exit
			else 
			echo "The cannons are primed and ready sir!"
			exit
			end
		elsif @fire == TRUE
			then
			if checkleft
			then
			fput "drop left"
			fput "drop right"
			echo "The cannons are primed and ready sir!"
			fire_cannons.call
			elsif checkright
			then
			fput "drop right"
			echo "The cannons are primed and ready sir!"
			fire_cannons.call
			else 
			echo "The cannons are primed and ready sir!"
			fire_cannons.call
			exit
			end
	
	end
end
}
	
get_balls = proc{
	waitrt?
	result = dothistimeout "get cannon ball", 5, /The sides of the|You cannot fire your|Thirty second warning|The weight of the cannon|...wait|you are out of cannon balls|You will need a free hand/
	if result =~ /The sides of the|You cannot fire your|Thirty second warning/
	ship_boarded.call
	elsif result =~ /You will need a free hand/
	(eval @return).call
	elsif result =~ /The weight of the cannon|...wait/
	get_balls.call
	elsif result =~ /you are out of cannon balls/
	@out = TRUE
	(eval @return).call
	end
}

fire_cannons = proc{
waitrt?
result = dothistimeout "fire cannon", 5, /The sides of the|You cannot fire your|Thirty second warning|You'll need to load|...wait|You fire a/
if result =~ /The sides of the|You cannot fire your|Thirty second warning/
	ship_boarded.call
elsif result =~ /You'll need to load/
	load_cannon.call
elsif result =~ /...wait|You fire a/
	fire_cannons.call
end
}

check_balls = proc{
result = dothistimeout "look", 5, /The sides of the|You cannot fire your|Thirty second warning|an iron cannon ball|Obvious (paths|exits):/
if result =~ /The sides of the|You cannot fire your|Thirty second warning/
ship_boarded.call
elsif result =~ /an iron cannon ball/
	fput "take cannon ball"
	load_cannon.call
elsif result =~ /Obvious (paths|exits):/
	if @out == TRUE
	echo "We are out of balls sir!"
	exit
	else
	(eval @deck).call
end
end
}
	
load_cannon = proc{
waitrt?
result = dothistimeout "load cannon", 5, /Thirty second warning|The sides of the|You cannot fire your|You carefully lift your|You need to be holding|The (.*) cannon already|...wait/
	if result =~ /The sides of the|You cannot fire your|Thirty second warning/
	ship_boarded.call
	elsif result =~ /You carefully lift your|...wait/
	load_cannon.call
	elsif result =~ /You need to be holding/
	check_balls.call
	elsif result =~ /The (.*) cannon already/
		waitrt?
		if @fire == FALSE
			then
			if checkleft
			then
			@done = TRUE
			(eval @deck).call
			fput "put ball in balls"
			fput "put ball in balls"
			echo "The cannons are primed and ready sir!"
			exit
			elsif checkright
			then
			@done = TRUE
			(eval @deck).call
			fput "put ball in balls"
			echo "The cannons are primed and ready sir!"
			exit
			else 
			echo "The cannons are primed and ready sir!"
			exit
			end
		elsif @fire == TRUE
			then
			if checkleft
			then
			fput "drop left"
			fput "drop right"
			echo "The cannons are primed and ready sir!"
			fire_cannons.call
			elsif checkright
			then
			fput "drop right"
			echo "The cannons are primed and ready sir!"
			fire_cannons.call
			else 
			echo "The cannons are primed and ready sir!"
			fire_cannons.call
			exit
			end
	
	end
end
}

main_wood = proc{
	@move = "up"
	move.call
	load_cannon.call
}
	
	cargo_wood = proc{
	load_cannon.call
}
	
	crow_wood = proc{
	@move = "up"
	move.call
	@move = "up"
	move.call
	load_cannon.call
}
	
	mcrow_wood = proc{
	@move = "up"
	move.call
	@move = "east"
	move.call
	@move = "east"
	move.call
	@move = "up"
	load_cannon.call
}
	
	helm_wood = proc{
	@move = "up"
	move.call
	@move = "west"
	move.call
	load_cannon.call
}
	
	cq_wood = proc{
	@move = "up"
	move.call
	@move = "west"
	move.call
	stand_up.call
	fput "go door"
	pause
	load_cannon.call
}
	
	forward_wood = proc{
	@move = "up"
	move.call
	@move = "east"
	move.call
	load_cannon.call
}
	
	mforward_wood = proc{
	@move = "up"
	move.call
	@move = "east"
	move.call
	@move = "east"
	move.call
	load_cannon.call
}
	
	bow_wood = proc{
	@move = "up"
	move.call
	@move = "east"
	move.call
	@move = "east"
	move.call
	load_cannon.call
}
	
	mbow_wood = proc{
	@move = "up"
	move.call
	@move = "east"
	move.call
	@move = "east"
	move.call
	@move = "east"
	move.call
	load_cannon.call
}
	
	mess_wood = proc{
	@move = "east"
	move.call
	load_cannon.call
}
	
	crew_wood = proc{
	@move = "west"
	move.call
	load_cannon.call
}
	
	mid_wood = proc{
	@move = "up"
	move.call
	@move = "east"
	move.call
	load_cannon.call
}

main_cargo = proc{
	@move = "down"
	move.call
	if @done == TRUE
	then 
	next
	elsif
	get_balls.call
end
}
	
	cargo_cargo = proc{
	if @done == TRUE
	then 
	next
	elsif
	get_balls.call
end
}
	
	crow_cargo = proc{
	@move = "down"
	move.call
	@move = "down"
	move.call
	if @done == TRUE
	then 
	next
	elsif
	get_balls.call
end
}
	
	helm_cargo = proc{
	@move = "east"
	move.call
	@move = "down"
	move.call
	if @done == TRUE
	then 
	next
	elsif
	get_balls.call
end
}
	
	cq_cargo = proc{
	@move = "out"
	move.call
	@move = "east"
	move.call
	@move = "down"
	move.call
	if @done == TRUE
	then 
	next
	elsif
	get_balls.call
end
}
	
	mforward_cargo = proc{
	@move = "west"
	move.call 
	@move = "west"
	move.call 
	@move = "down"
	move.call
	if @done == TRUE
	then 
	next
	elsif
	get_balls.call
end
}
	
	mcrow_cargo = proc{
	@move = "down"
	move.call
	@move = "west"
	move.call
	@move = "west"
	move.call
	@move = "down"
	if @done == TRUE
	then 
	next
	elsif
	get_balls.call
end
}
	
	forward_cargo = proc{
	@move = "west"
	move.call 
	@move = "down"
	move.call
	if @done == TRUE
	next
	elsif
	get_balls.call
end
}

	bow_cargo = proc{
	@move = "west"
	move.call
	@move = "west"
	move.call 
	@move = "down"
	move.call 
	if @done == TRUE
	then 
	next
	elsif
	get_balls.call
end
}
	
	mbow_cargo = proc{
	@move = "west"
	move.call
	@move = "west"
	move.call
	@move = "west"
	move.call
	@move = "down"
	move.call
	if @done == TRUE
	then 
	next
	elsif	
	get_balls.call
end
}
	
	mess_cargo = proc{
	@move = "west"
	move.call
	if @done == TRUE
	then 
	next
	elsif
	get_balls.call
end	
}
	
	crew_cargo = proc{
	@move = "east"
	move.call
	if @done == TRUE
	then 
	next
	elsif
	get_balls.call
end
}
	
	mid_cargo = proc{
	@move = "west"
	move.call 
	@move = "down"
	move.call
	if @done == TRUE
	then 
	next
	elsif
	get_balls.call
end
}

which_crow = proc{
fput "peer down"
while line = get
	if line =~ /(.*)Man O\' War, Forward Deck(.)/
	mcrow_cargo.call
	else 
	crow_cargo.call
end
end
}

start_loading = proc{
@done = FALSE
fput "look"
while line = get
		if line =~ /(.*), Main Deck(.*)/
		main_cargo.call
		elsif line =~ /(.*), Cargo Hold(.)/
		cargo_cargo.call
		elsif line =~ /(.*), Crow\'s Nest(.)/
		which_crow.call
		elsif line =~ /(.*), Helm(.)/
		helm_cargo.call
		elsif line =~ /(.*), Captain\'s Quarters(.)/
		cq_cargo.call
		elsif line =~ /(.*)Man O\' War, Forward Deck(.)/
		mforward_cargo.call
		elsif line =~ /(.*), Forward Deck(.)/
		forward_cargo.call
		elsif line =~ /(.*)Man O\' War, Bow(.)/
		mbow_cargo.call
		elsif line =~ /(.*), Bow(.)/
		bow_cargo.call
		elsif line =~ /(.*), Mess Hall(.)/
		mess_cargo.call
		elsif line =~ /(.*), Crew Quarters(.)/
		crew_cargo.call
		elsif line =~ /(.*), Mid Deck(.)/
		mid_cargo.call
end
end
}

two_deck = proc{
respond "


=======================================
Which Cannons\?
    1\. Main Deck
    2\. Forward Deck
=======================================
Select your cannons - 
      ;send <#> "
respond
clear
line = nil
line = get until line.strip =~ /^[0-9]+$/
mode = line
if mode == "1"
	@deck = "main_cargo"
	@return = "main_wood"
	start_loading.call
elsif mode == "2"
	@deck = "forward_cargo"
	@return = "forward_wood"
	start_loading.call
	end
}


three_deck = proc{
respond "


=======================================
Which Cannons\?
    1\. Main Deck
    2\. Mid Deck
    3\. Forward Deck		
=======================================
Select your cannons - 
      ;send <#> "
respond
clear
line = nil
line = get until line.strip =~ /^[0-9]+$/
mode = line
if mode == "1"
	@deck = "main_cargo"
	@return = "main_wood"
	start_loading.call
elsif mode == "2"
	@deck = "mid_cargo"
	@return = "mid_wood"
	start_loading.call
elsif mode == "3"
	@deck = "mforward_cargo"
	@return = "mforward_wood"
	start_loading.call
	end
}



ship_type = proc{
fput "look"
while line = get
		if line =~ /(.*)(Sloop|Brigantine|Carrack|Galleon|Frigate|Man O\' War)/
			if $2 == "Sloop" 
			then
			@shiptype = "sloop"
			@deck = "main_cargo"
			@return = "main_wood"
					start_loading.call
			elsif $2 == "Brigantine"
			then
			@shiptype = "brigantine"
			two_deck.call
			elsif $2 == "Carrack"
			then
			@shiptype = "carrack"
			two_deck.call
			elsif $2 == "Galleon"
			then
			@shiptype = "galleon"
			two_deck.call
			elsif $2 == "Frigate"
			then
			@shiptype = "frigate"
			two_deck.call
			elsif $2 == "Man O\' War"
			then
			@shiptype = "manowar"
			three_deck.call
			end
end
end
}

set_mode = proc{
respond "
=======================================
Will you be priming the load only or will you be gunning the enemy as well\?
    1\. Prime the Cannons!
    2\. Blast Em\'
=======================================
Select your mode - 
      ;send <#> "
respond
clear
line = nil
line = get until line.strip =~ /^[0-9]+$/
mode = line
if mode == "1"
	@fire = FALSE
	ship_type.call
elsif mode == "2"
	@fire = TRUE
	ship_type.call
	end
}
if variable[1].downcase =~ /help/
	echo "This script will prime and ready your cannons, then if desired fire them at the enemy vessel.
It is important to know that it is not programmed to stop when the enemy throws thier grappels, so be vigilant and ready to kill the script when its time.
This script is not intended to be used AFK in anyway.
Enjoy

~Peggyanne
PS: feel free to send me any bugs via discord Bait#4376 and I'll try my best to fix them.
2/16/2021 Initial Release, Should support all ship types.
2/19/2021 Now clears your hands and exits when you are boarded (Sorry I didn't do this sooner guys!)
9/11/2021 Will TRY to clear your hands when you run the script, if unable it will exit out and tell you to clear your hands."
exit
end
respond "      ====================================================================================================================================
            *****User beware, this script is not meant for AFK use. The sea is a fickle beast and there can be unforseen events***** 
								                                                 Take No Prisoners Captain!
		      ==================================================================================================================================== 			"
@out = FALSE
fput "stow all"
if checkleft or checkright
echo "









             ******************* YOU MUST EMPTY YOUR HANDS BEFORE RUNNING GUNNERSMATE.LIC *********************








"
exit
end
set_mode.call