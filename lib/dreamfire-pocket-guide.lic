=begin
Description

This is the Dreamfire Bracelet Pocket Guide for quick reference. All the commands your bracelet will do will be listed out on one line per command for this amazing, flexible, and complex illusion system available to all races and professions. As you unlock your bracelet further, the script detects it and outputs the new commands.

Instructions:  ;dreamfire-pocket-guide help

    author: Luxelle
    game: Gemstone
    tags: dreamfire, illusion, bracelet, panel, illusions, guide

    Usage: dreamfire-pocket-guide help
           dreamfire-pocket-guide raxiara

    Changelog: 
          Version 1.1 - couple fixes September 28 2025          
          Version 1.0 - initial release.  September 27 2025
=end


#echo "#{script.vars[0]}"
line = ""
if script.vars[0] == "help"
	respond "Usage: ;#{script.name} <bracelet name>"
    respond "IE: ;#{script.name} raxiara"
    respond "Or: ;#{script.name} pearl bracelet"
    respond " "

    exit
end
if script.vars.count <= 1
    respond "Usage: ;#{script.name} <bracelet name>"
    respond "IE: ;#{script.name} raxiara"
    respond "Or: ;#{script.name} pearl bracelet"
    respond " "
    exit
end

dreamfire = script.vars[0]

# Scraping Loop
fput "analyze my #{dreamfire}"
until line =~ /Mana Stored:/
  line = get

  # Get Tier
  if line =~ /Unlock Tier: (.*) \s+ Illusion Style/
    tier = $1.to_i
  end

  # Get attachments
  if line =~ /Attachments: (.*) \s+ Gesture Style:/
    attach = $1.to_i
  end

end

#echo "Tier: #{tier}"
#echo "Attachments: #{attach}"
respond "Dreamfire Illusions Pocket Guide"
respond " "
if tier > 0
respond "T1: WEAR/REMOVE"
respond "    PUSH/PULL (attach/remove panels)"
respond "    PEER (see all panels, you peering at it is invisible to others)"
respond "    RUB (create illusion of selected panel)"
respond "    LOOK/SHOW (appends attachment count and current panel info)"
end

if tier >1
respond "T2: INFUSE (adds mana)"
respond "    GAZE (quietly preview current panel, both illusions)"
respond "    WAVE (create concealed illusion of current panel)"
respond "    SNAP (fluff - current panel illusion appears briefly above your palm)"
end

if tier >2
respond "T3: FLIP (Toggles Fluff designated verbs to use other side of panel)"
respond "    TILT (fluff - attention to current panel)"
respond "    WAGGLE (fluff - waggles current selection to appear briefly in the air)"
end

if tier >3
respond "T4: TICKLE (fluff - brush fingers, illusion appears briefly)"
respond "    POINT (at illusion to extend by 1 min per tier, 10min max)"
respond "    DISMISS (dismiss all illusions even if not in room with you)"
end

if tier >4
respond "T5: NUDGE (fluff - sweeping gesture and color/material appear)"
respond "    PINCH (Toggle between creating dissipating and static illusions)"
end

if attach >1
respond " "
respond "Attachment Points Verb Additions:"
respond " 2+ TURN (cycle through selection panel in the bracelet)"
end

if attach >2
respond " 3+ TWIST (silently cycle panels in bracelet)"
respond "    TURN/TWIST bracelet to # (choose specific active panel by number)"
end

if attach >4
respond " 5+ FIDGET (randomly select from one of main panels, displays panel selection to others)"
end

if attach >7
respond " 8+ SPIN (randomly select panel and reveal illusion, can select concealed illusions via FLIP)"
end

if attach >9
respond "10+ EMPTY (transfer panels to storage case)"
end

if attach >11
respond "12+ FLICK (find empty attachment)"
end

if attach >14
respond "15+ LOWER (random multi image spread, number selected in PROD setting) *Can target at someone!"
respond "    PROD (toggle image count for LOWER command, range is 3-5)"
end

respond " "
respond "All the specific details are at the wiki: https://gswiki.play.net/Dreamfire_Panel_Bracelet"
respond " "

